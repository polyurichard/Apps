<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DynamoDB Interactive Simulation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        /* Animation for records moving between shards */
        @keyframes moveRecord {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(0.8); opacity: 0.5; transform: translateY(20px); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .record-moving {
            animation: moveRecord 1s ease-in-out;
        }
        
        /* Shard color variations */
        .shard-0 {
            background-color: rgba(99, 102, 241, 0.05);
            border-color: rgba(99, 102, 241, 0.5);
        }
        
        .shard-1 {
            background-color: rgba(236, 72, 153, 0.05);
            border-color: rgba(236, 72, 153, 0.5);
        }
        
        .shard-2 {
            background-color: rgba(245, 158, 11, 0.05);
            border-color: rgba(245, 158, 11, 0.5);
        }
        
        .shard-3 {
            background-color: rgba(16, 185, 129, 0.05);
            border-color: rgba(16, 185, 129, 0.5);
        }
        
        .shard-4 {
            background-color: rgba(6, 182, 212, 0.05);
            border-color: rgba(6, 182, 212, 0.5);
        }
        
        /* Dark mode shard colors */
        .dark .shard-0 {
            background-color: rgba(99, 102, 241, 0.15);
            border-color: rgba(99, 102, 241, 0.4);
        }
        
        .dark .shard-1 {
            background-color: rgba(236, 72, 153, 0.15);
            border-color: rgba(236, 72, 153, 0.4);
        }
        
        .dark .shard-2 {
            background-color: rgba(245, 158, 11, 0.15);
            border-color: rgba(245, 158, 11, 0.4);
        }
        
        .dark .shard-3 {
            background-color: rgba(16, 185, 129, 0.15);
            border-color: rgba(16, 185, 129, 0.4);
        }
        
        .dark .shard-4 {
            background-color: rgba(6, 182, 212, 0.15);
            border-color: rgba(6, 182, 212, 0.4);
        }
        
        /* Dark mode support */
        .dark .record {
            background-color: rgba(55, 65, 81, 0.8);
            border-color: #4b5563;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .shard {
            transition: all 0.5s ease-in-out;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .record {
            transition: all 0.3s ease-in-out;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        /* Tooltip styles */
        .tooltip {
            position: relative;
            display: inline-flex;
            cursor: help;
        }
        
        .tooltip .tooltip-text {
            visibility: hidden;
            width: 240px;
            background-color: rgba(17, 24, 39, 0.95);
            color: #fff;
            text-align: left;
            border-radius: 6px;
            padding: 8px 12px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -120px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.875rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            line-height: 1.4;
        }
        
        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        
        .dark .tooltip .tooltip-text {
            background-color: rgba(31, 41, 55, 0.95);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.1);
        }
        
        .tooltip-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
            background: #e5e7eb;
            color: #4b5563;
            border-radius: 50%;
            font-size: 11px;
            margin-left: 4px;
        }
        
        .dark .tooltip-icon {
            background: #4b5563;
            color: #e5e7eb;
        }
        
        /* Help section list styling */
        .prose ol {
            list-style-type: decimal;
            padding-left: 1.5rem;
        }
        
        .prose ul {
            list-style-type: disc;
            padding-left: 1.5rem;
        }
        
        .prose li {
            margin-top: 0.25rem;
            margin-bottom: 0.25rem;
        }
    </style>
</head>
<body class="min-h-screen bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 transition-colors duration-200">
    <div class="container mx-auto px-4 py-6">
        <h1 class="text-3xl font-bold mb-4 text-center text-purple-600 dark:text-purple-400">
            DynamoDB Interactive Simulation
        </h1>
        
        <!-- Scenario Selector -->
        <div class="max-w-md mx-auto mb-6">
            <label for="scenario-selector" class="block text-sm font-medium mb-1 text-center">Select Scenario:</label>
            <select id="scenario-selector" class="w-full p-2 border dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-sm">
                <option value="student">Student Course Records</option>
                <option value="sensor">Temperature Sensor Data</option>
            </select>
        </div>
        
        <!-- Tabs Navigation -->
        <div class="flex border-b border-gray-300 dark:border-gray-700 mb-6 overflow-x-auto">
            <button class="tab-button px-6 py-3 font-medium text-sm focus:outline-none border-b-2 border-purple-600 dark:border-purple-400 text-purple-600 dark:text-purple-400" data-tab="overview">
                Overview
            </button>
            <button class="tab-button px-6 py-3 font-medium text-sm focus:outline-none border-b-2 border-transparent hover:border-gray-300 dark:hover:border-gray-700" data-tab="data-explorer">
                Data Explorer
            </button>
            <button class="tab-button px-6 py-3 font-medium text-sm focus:outline-none border-b-2 border-transparent hover:border-gray-300 dark:hover:border-gray-700" data-tab="shard-visualization">
                Shard Visualization
            </button>
            <button class="tab-button px-6 py-3 font-medium text-sm focus:outline-none border-b-2 border-transparent hover:border-gray-300 dark:hover:border-gray-700" data-tab="help">
                Help
            </button>
        </div>
        
        <!-- Tab Content -->
        <div class="tab-content">
            <!-- Overview Tab -->
            <div id="overview" class="tab-pane">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 prose dark:prose-invert max-w-none">
                    <!-- Student Overview (shown/hidden based on scenario) -->
                    <div id="student-overview">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center mr-4">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-indigo-600 dark:text-indigo-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2 1 3 3 3h10c2 0 3-1 3-3V7c0-2-1-3-3-3H7c-2 0-3 1-3 3z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 11h6M9 17h6" />
                                </svg>
                            </div>
                            <h2 class="text-2xl font-bold text-indigo-700 dark:text-indigo-400 m-0">Understanding DynamoDB with Student Course Records</h2>
                        </div>
                        
                        <div class="mb-6 bg-indigo-50 dark:bg-indigo-900/30 p-4 rounded-lg border border-indigo-100 dark:border-indigo-800">
                            <p class="text-indigo-800 dark:text-indigo-300 font-medium mb-2">This simulation helps you understand how Amazon DynamoDB works using student course records. You'll learn about:</p>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mt-3">
                                <div class="bg-white dark:bg-gray-800 p-3 rounded-md border border-indigo-100 dark:border-indigo-800 shadow-sm">
                                    <div class="flex items-center mb-2">
                                        <span class="w-8 h-8 rounded-full bg-purple-100 dark:bg-purple-900 inline-flex items-center justify-center mr-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-purple-600 dark:text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                                            </svg>
                                        </span>
                                        <span class="font-semibold text-purple-700 dark:text-purple-400">Partition &amp; Sort Keys</span>
                                    </div>
                                    <p class="text-sm text-gray-600 dark:text-gray-300">How these keys affect data distribution across DynamoDB's shards</p>
                                </div>
                                <div class="bg-white dark:bg-gray-800 p-3 rounded-md border border-indigo-100 dark:border-indigo-800 shadow-sm">
                                    <div class="flex items-center mb-2">
                                        <span class="w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900 inline-flex items-center justify-center mr-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-600 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z" />
                                            </svg>
                                        </span>
                                        <span class="font-semibold text-blue-700 dark:text-blue-400">Data Distribution</span>
                                    </div>
                                    <p class="text-sm text-gray-600 dark:text-gray-300">Visualize how records are distributed based on key choices</p>
                                </div>
                                <div class="bg-white dark:bg-gray-800 p-3 rounded-md border border-indigo-100 dark:border-indigo-800 shadow-sm">
                                    <div class="flex items-center mb-2">
                                        <span class="w-8 h-8 rounded-full bg-green-100 dark:bg-green-900 inline-flex items-center justify-center mr-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-green-600 dark:text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                            </svg>
                                        </span>
                                        <span class="font-semibold text-green-700 dark:text-green-400">Shard Configuration</span>
                                    </div>
                                    <p class="text-sm text-gray-600 dark:text-gray-300">See how changing shard numbers affects distribution balance</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                            <div>
                                <h3 class="text-xl font-bold text-gray-800 dark:text-gray-200 flex items-center">
                                    <span class="w-6 h-6 rounded-full bg-teal-100 dark:bg-teal-900 inline-flex items-center justify-center mr-2 text-teal-600 dark:text-teal-400 text-xs">1</span>
                                    The Scenario
                                </h3>
                                <p>We have a database of student course records with the following attributes:</p>
                                <div class="bg-white dark:bg-gray-700 rounded-md shadow-sm p-3 border border-gray-200 dark:border-gray-600">
                                    <ul class="space-y-2 text-sm">
                                        <li class="flex items-center">
                                            <span class="w-4 h-4 bg-purple-100 dark:bg-purple-900 rounded-sm inline-flex items-center justify-center mr-2">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-purple-600 dark:text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                                </svg>
                                            </span>
                                            <strong>Student ID:</strong> Unique identifier for each student
                                        </li>
                                        <li class="flex items-center">
                                            <span class="w-4 h-4 bg-purple-100 dark:bg-purple-900 rounded-sm inline-flex items-center justify-center mr-2">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-purple-600 dark:text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                                </svg>
                                            </span>
                                            <strong>Student Name:</strong> Full name of the student
                                        </li>
                                        <li class="flex items-center">
                                            <span class="w-4 h-4 bg-purple-100 dark:bg-purple-900 rounded-sm inline-flex items-center justify-center mr-2">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-purple-600 dark:text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                                </svg>
                                            </span>
                                            <strong>Gender:</strong> Student's gender
                                        </li>
                                        <li class="flex items-center">
                                            <span class="w-4 h-4 bg-blue-100 dark:bg-blue-900 rounded-sm inline-flex items-center justify-center mr-2">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-blue-600 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                                </svg>
                                            </span>
                                            <strong>Course ID:</strong> Identifier for each course
                                        </li>
                                        <li class="flex items-center">
                                            <span class="w-4 h-4 bg-blue-100 dark:bg-blue-900 rounded-sm inline-flex items-center justify-center mr-2">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-blue-600 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                                </svg>
                                            </span>
                                            <strong>Course Name:</strong> Name of the course
                                        </li>
                                        <li class="flex items-center">
                                            <span class="w-4 h-4 bg-green-100 dark:bg-green-900 rounded-sm inline-flex items-center justify-center mr-2">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-green-600 dark:text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                                </svg>
                                            </span>
                                            <strong>Grade:</strong> The student's grade in that course
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div>
                                <h3 class="text-xl font-bold text-gray-800 dark:text-gray-200 flex items-center">
                                    <span class="w-6 h-6 rounded-full bg-teal-100 dark:bg-teal-900 inline-flex items-center justify-center mr-2 text-teal-600 dark:text-teal-400 text-xs">2</span>
                                    Key Concepts Demonstrated
                                </h3>
                                <div class="space-y-3">
                                    <div class="bg-purple-50 dark:bg-purple-900/20 p-3 rounded-md border border-purple-100 dark:border-purple-800 shadow-sm">
                                        <p class="font-medium text-purple-800 dark:text-purple-300 mb-1">Partition Key Selection</p>
                                        <p class="text-sm text-gray-600 dark:text-gray-300">Determines how data is physically distributed across shards</p>
                                    </div>
                                    <div class="bg-blue-50 dark:bg-blue-900/20 p-3 rounded-md border border-blue-100 dark:border-blue-800 shadow-sm">
                                        <p class="font-medium text-blue-800 dark:text-blue-300 mb-1">Sort Key Selection</p>
                                        <p class="text-sm text-gray-600 dark:text-gray-300">Organizes data within a partition</p>
                                    </div>
                                    <div class="bg-red-50 dark:bg-red-900/20 p-3 rounded-md border border-red-100 dark:border-red-800 shadow-sm">
                                        <p class="font-medium text-red-800 dark:text-red-300 mb-1">Hot Partitions</p>
                                        <p class="text-sm text-gray-600 dark:text-gray-300">See how certain key choices can lead to uneven data distribution</p>
                                    </div>
                                    <div class="bg-green-50 dark:bg-green-900/20 p-3 rounded-md border border-green-100 dark:border-green-800 shadow-sm">
                                        <p class="font-medium text-green-800 dark:text-green-300 mb-1">Shard Adjustment</p>
                                        <p class="text-sm text-gray-600 dark:text-gray-300">Observe how changing the number of shards affects distribution balance</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <h3 class="text-xl font-bold text-gray-800 dark:text-gray-200 flex items-center">
                                <span class="w-6 h-6 rounded-full bg-teal-100 dark:bg-teal-900 inline-flex items-center justify-center mr-2 text-teal-600 dark:text-teal-400 text-xs">3</span>
                                How to Use This Simulation
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-3">
                                <div class="flex">
                                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center mr-3">
                                        <span class="text-indigo-600 dark:text-indigo-400 font-semibold">1</span>
                                    </div>
                                    <div>
                                        <p class="mb-1 font-medium">Browse the <span class="text-indigo-600 dark:text-indigo-400">Data Explorer</span> tab</p>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">See the raw data we'll be working with</p>
                                    </div>
                                </div>
                                <div class="flex">
                                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center mr-3">
                                        <span class="text-indigo-600 dark:text-indigo-400 font-semibold">2</span>
                                    </div>
                                    <div>
                                        <p class="mb-1 font-medium">Go to <span class="text-indigo-600 dark:text-indigo-400">Shard Visualization</span></p>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Experiment with different key combinations</p>
                                    </div>
                                </div>
                                <div class="flex">
                                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center mr-3">
                                        <span class="text-indigo-600 dark:text-indigo-400 font-semibold">3</span>
                                    </div>
                                    <div>
                                        <p class="mb-1 font-medium">Adjust the <span class="text-indigo-600 dark:text-indigo-400">number of shards</span></p>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">See how it affects data distribution</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg border border-blue-100 dark:border-blue-800 shadow-sm mt-4">
                            <div class="flex items-start">
                                <div class="flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-800 flex items-center justify-center mr-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                </div>
                                <div>
                                    <h4 class="text-lg font-semibold text-blue-800 dark:text-blue-300 mt-0">Why This Matters</h4>
                                    <p class="text-blue-700 dark:text-blue-200 mb-0">The choice of partition key directly impacts performance, costs, and scalability. A poor choice can lead to "hot partitions" (overloaded shards) while other shards remain underutilized. Understanding these concepts helps you design efficient database schemas for your applications.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Sensor Overview (shown/hidden based on scenario) -->
                    <div id="sensor-overview" class="hidden">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 rounded-full bg-teal-100 dark:bg-teal-900 flex items-center justify-center mr-4">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-teal-600 dark:text-teal-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                </svg>
                            </div>
                            <h2 class="text-2xl font-bold text-teal-700 dark:text-teal-400 m-0">Understanding DynamoDB with Temperature Sensor Data</h2>
                        </div>
                        
                        <div class="mb-6 bg-teal-50 dark:bg-teal-900/30 p-4 rounded-lg border border-teal-100 dark:border-teal-800">
                            <p class="text-teal-800 dark:text-teal-300 font-medium mb-2">This simulation helps you understand how Amazon DynamoDB works using temperature sensor data. You'll learn about:</p>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mt-3">
                                <div class="bg-white dark:bg-gray-800 p-3 rounded-md border border-teal-100 dark:border-teal-800 shadow-sm">
                                    <div class="flex items-center mb-2">
                                        <span class="w-8 h-8 rounded-full bg-teal-100 dark:bg-teal-900 inline-flex items-center justify-center mr-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-teal-600 dark:text-teal-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                                            </svg>
                                        </span>
                                        <span class="font-semibold text-teal-700 dark:text-teal-400">Time-Series Data</span>
                                    </div>
                                    <p class="text-sm text-gray-600 dark:text-gray-300">How to effectively store and retrieve time-series data in DynamoDB</p>
                                </div>
                                <div class="bg-white dark:bg-gray-800 p-3 rounded-md border border-teal-100 dark:border-teal-800 shadow-sm">
                                    <div class="flex items-center mb-2">
                                        <span class="w-8 h-8 rounded-full bg-teal-100 dark:bg-teal-900 inline-flex items-center justify-center mr-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-teal-600 dark:text-teal-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z" />
                                            </svg>
                                        </span>
                                        <span class="font-semibold text-teal-700 dark:text-teal-400">Location-Based Keys</span>
                                    </div>
                                    <p class="text-sm text-gray-600 dark:text-gray-300">Observe distribution patterns with geographical data</p>
                                </div>
                                <div class="bg-white dark:bg-gray-800 p-3 rounded-md border border-teal-100 dark:border-teal-800 shadow-sm">
                                    <div class="flex items-center mb-2">
                                        <span class="w-8 h-8 rounded-full bg-teal-100 dark:bg-teal-900 inline-flex items-center justify-center mr-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-teal-600 dark:text-teal-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                            </svg>
                                        </span>
                                        <span class="font-semibold text-teal-700 dark:text-teal-400">IoT Data Patterns</span>
                                    </div>
                                    <p class="text-sm text-gray-600 dark:text-gray-300">Learn best practices for storing Internet of Things (IoT) data</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                            <div>
                                <h3 class="text-xl font-bold text-gray-800 dark:text-gray-200 flex items-center">
                                    <span class="w-6 h-6 rounded-full bg-teal-100 dark:bg-teal-900 inline-flex items-center justify-center mr-2 text-teal-600 dark:text-teal-400 text-xs">1</span>
                                    The Scenario
                                </h3>
                                <p>We have a database of temperature readings from sensors with the following attributes:</p>
                                <div class="bg-white dark:bg-gray-700 rounded-md shadow-sm p-3 border border-gray-200 dark:border-gray-600">
                                    <ul class="space-y-2 text-sm">
                                        <li class="flex items-center">
                                            <span class="w-4 h-4 bg-teal-100 dark:bg-teal-900 rounded-sm inline-flex items-center justify-center mr-2">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-teal-600 dark:text-teal-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                                </svg>
                                            </span>
                                            <strong>Sensor ID:</strong> Unique identifier for each sensor
                                        </li>
                                        <li class="flex items-center">
                                            <span class="w-4 h-4 bg-teal-100 dark:bg-teal-900 rounded-sm inline-flex items-center justify-center mr-2">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-teal-600 dark:text-teal-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                                </svg>
                                            </span>
                                            <strong>Location:</strong> Physical location where the reading was captured
                                        </li>
                                        <li class="flex items-center">
                                            <span class="w-4 h-4 bg-teal-100 dark:bg-teal-900 rounded-sm inline-flex items-center justify-center mr-2">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-teal-600 dark:text-teal-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                                </svg>
                                            </span>
                                            <strong>Timestamp:</strong> When the reading was recorded (Sort Key)
                                        </li>
                                        <li class="flex items-center">
                                            <span class="w-4 h-4 bg-teal-100 dark:bg-teal-900 rounded-sm inline-flex items-center justify-center mr-2">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-teal-600 dark:text-teal-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                                </svg>
                                            </span>
                                            <strong>Temperature:</strong> The recorded temperature value
                                        </li>
                                        <li class="flex items-center">
                                            <span class="w-4 h-4 bg-teal-100 dark:bg-teal-900 rounded-sm inline-flex items-center justify-center mr-2">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-teal-600 dark:text-teal-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                                </svg>
                                            </span>
                                            <strong>Unit:</strong> Temperature measurement unit (e.g., °C)
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div>
                                <h3 class="text-xl font-bold text-gray-800 dark:text-gray-200 flex items-center">
                                    <span class="w-6 h-6 rounded-full bg-teal-100 dark:bg-teal-900 inline-flex items-center justify-center mr-2 text-teal-600 dark:text-teal-400 text-xs">2</span>
                                    Key Concepts Demonstrated
                                </h3>
                                <div class="space-y-3">
                                    <div class="bg-teal-50 dark:bg-teal-900/20 p-3 rounded-md border border-teal-100 dark:border-teal-800 shadow-sm">
                                        <p class="font-medium text-teal-800 dark:text-teal-300 mb-1">Time-Series Data Management</p>
                                        <p class="text-sm text-gray-600 dark:text-gray-300">Handling frequent, time-stamped measurements efficiently</p>
                                    </div>
                                    <div class="bg-teal-50 dark:bg-teal-900/20 p-3 rounded-md border border-teal-100 dark:border-teal-800 shadow-sm">
                                        <p class="font-medium text-teal-800 dark:text-teal-300 mb-1">Location-Based Distribution</p>
                                        <p class="text-sm text-gray-600 dark:text-gray-300">Managing data from different physical locations</p>
                                    </div>
                                    <div class="bg-red-50 dark:bg-red-900/20 p-3 rounded-md border border-red-100 dark:border-red-800 shadow-sm">
                                        <p class="font-medium text-red-800 dark:text-red-300 mb-1">Timestamp Hot Spots</p>
                                        <p class="text-sm text-gray-600 dark:text-gray-300">See how using timestamps as partition keys can create hot spots</p>
                                    </div>
                                    <div class="bg-green-50 dark:bg-green-900/20 p-3 rounded-md border border-green-100 dark:border-green-800 shadow-sm">
                                        <p class="font-medium text-green-800 dark:text-green-300 mb-1">Composite Keys for IoT</p>
                                        <p class="text-sm text-gray-600 dark:text-gray-300">Learn effective partitioning strategies for sensor data</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <h3 class="text-xl font-bold text-gray-800 dark:text-gray-200 flex items-center">
                                <span class="w-6 h-6 rounded-full bg-teal-100 dark:bg-teal-900 inline-flex items-center justify-center mr-2 text-teal-600 dark:text-teal-400 text-xs">3</span>
                                How to Use This Simulation
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-3">
                                <div class="flex">
                                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-teal-100 dark:bg-teal-900 flex items-center justify-center mr-3">
                                        <span class="text-teal-600 dark:text-teal-400 font-semibold">1</span>
                                    </div>
                                    <div>
                                        <p class="mb-1 font-medium">Browse the <span class="text-teal-600 dark:text-teal-400">Data Explorer</span> tab</p>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">See the sensor data measurements</p>
                                    </div>
                                </div>
                                <div class="flex">
                                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-teal-100 dark:bg-teal-900 flex items-center justify-center mr-3">
                                        <span class="text-teal-600 dark:text-teal-400 font-semibold">2</span>
                                    </div>
                                    <div>
                                        <p class="mb-1 font-medium">Go to <span class="text-teal-600 dark:text-teal-400">Shard Visualization</span></p>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Experiment with different key combinations</p>
                                    </div>
                                </div>
                                <div class="flex">
                                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-teal-100 dark:bg-teal-900 flex items-center justify-center mr-3">
                                        <span class="text-teal-600 dark:text-teal-400 font-semibold">3</span>
                                    </div>
                                    <div>
                                        <p class="mb-1 font-medium">Test different <span class="text-teal-600 dark:text-teal-400">partitioning strategies</span></p>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">See the impact on IoT data distribution</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg border border-blue-100 dark:border-blue-800 shadow-sm mt-4">
                            <div class="flex items-start">
                                <div class="flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-800 flex items-center justify-center mr-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                </div>
                                <div>
                                    <h4 class="text-lg font-semibold text-blue-800 dark:text-blue-300 mt-0">Why This Matters</h4>
                                    <p class="text-blue-700 dark:text-blue-200 mb-0">IoT and time-series data present unique challenges in DynamoDB. Ineffective partitioning strategies can lead to costly performance issues as data volumes grow. By understanding these concepts, you can design systems that scale with your sensor network.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Data Explorer Tab -->
            <div id="data-explorer" class="tab-pane hidden">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-indigo-600 dark:text-indigo-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2 1 3 3 3h10c2 0 3-1 3-3V7c0-2-1-3-3-3H7c-2 0-3 1-3 3z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 11h6M9 17h6" />
                        </svg>
                        Data Explorer
                    </h2>
                    
                    <!-- Student Records Explorer -->
                    <div id="student-data-explorer">
                        <p class="mb-4">Below are all records from our student course dataset. These records will be distributed across shards based on your partition and sort key selections.</p>
                        
                        <div class="overflow-auto max-h-96 bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                            <pre id="student-data-json" class="text-xs md:text-sm"></pre>
                        </div>
                    </div>
                    
                    <!-- Sensor Data Explorer -->
                    <div id="sensor-data-explorer" class="hidden">
                        <p class="mb-4">Below are all temperature readings from our sensor network. These records will be distributed across shards based on your partition and sort key selections.</p>
                        
                        <div class="overflow-auto max-h-96 bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                            <pre id="sensor-data-json" class="text-xs md:text-sm"></pre>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Shard Visualization Tab -->
            <div id="shard-visualization" class="tab-pane hidden">
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-4">
                    <div class="lg:col-span-4">
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-4">
                            <h2 class="text-lg font-semibold mb-3">Data Stats</h2>
                            
                            <!-- Stats -->
                            <div class="grid grid-cols-2 gap-2 text-xs mb-4">
                                <div class="p-2 bg-gray-100 dark:bg-gray-700 rounded-md">
                                    <p class="font-medium mb-0.5">Total Records</p>
                                    <p id="total-records" class="text-xl font-bold">20</p>
                                </div>
                                <div class="p-2 bg-gray-100 dark:bg-gray-700 rounded-md">
                                    <p class="font-medium mb-0.5">Max Items/Shard</p>
                                    <p id="max-items" class="text-xl font-bold">8</p>
                                </div>
                                <div class="col-span-2 p-2 bg-gray-100 dark:bg-gray-700 rounded-md">
                                    <p class="font-medium mb-0.5 flex items-center">
                                        Distribution Score
                                        <span class="tooltip ml-1">
                                            <span class="tooltip-icon">i</span>
                                            <span class="tooltip-text">A measure of how evenly data is distributed across shards (100% = perfectly even). Higher scores indicate better distribution and potentially better performance.</span>
                                        </span>
                                    </p>
                                    <p id="distribution-score" class="text-xl font-bold">72%</p>
                                </div>
                            </div>
                            
                            <!-- Visualization of partition key distribution -->
                            <div class="mb-4">
                                <h3 class="text-xs font-medium mb-2 flex items-center">Partition Key Distribution
                                    <span class="tooltip ml-1">
                                        <span class="tooltip-icon">i</span>
                                        <span class="tooltip-text">This chart shows the distribution of partition key values. For a good partition key, values should be evenly distributed and have high cardinality (many different values).</span>
                                    </span>
                                </h3>
                                <div id="key-distribution" class="h-64 bg-gray-100 dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-700 overflow-hidden p-2 flex items-center justify-center">
                                    <!-- Pie chart will be rendered here -->
                                </div>
                            </div>
                            
                            <!-- Query Section -->
                            <div class="border-t border-gray-200 dark:border-gray-700 pt-3 mb-4">
                                <h3 class="text-xs font-medium mb-2 flex items-center">
                                    Sample Queries
                                    <span class="tooltip ml-1">
                                        <span class="tooltip-icon">i</span>
                                        <span class="tooltip-text">Try these queries to see which shards are accessed and how the data is retrieved. Records matching the query will be highlighted.</span>
                                    </span>
                                </h3>
                                
                                <!-- Student Queries -->
                                <select id="student-query-selector" class="w-full p-1.5 mb-2 border dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-xs">
                                    <option value="none">No Query (Show All Data)</option>
                                    <option value="student-S1001">Find all courses for Student S1001</option>
                                    <option value="course-CS101">Find all students in course CS101</option>
                                    <option value="grade-A">Find all records with grade A</option>
                                    <option value="gender-Female">Find all female students</option>
                                </select>
                                
                                <!-- Sensor Queries -->
                                <select id="sensor-query-selector" class="w-full p-1.5 mb-2 border dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-xs hidden">
                                    <option value="none">No Query (Show All Data)</option>
                                    <option value="sensor-sensor001">Find all readings from sensor001</option>
                                    <option value="temperature-above-30">Find readings above 30°C</option>
                                    <option value="location-New York">Find readings from New York</option>
                                    <option value="time-morning">Find morning readings (6AM-12PM)</option>
                                </select>
                                
                                <div id="query-info" class="bg-blue-50 dark:bg-blue-900/30 p-2 rounded-md text-xs hidden">
                                    <p class="font-medium text-blue-700 dark:text-blue-300 mb-1">Query Details</p>
                                    <p class="text-blue-600 dark:text-blue-400 mb-1" id="query-details"></p>
                                    <p class="text-blue-600 dark:text-blue-400" id="query-results"></p>
                                </div>
                            </div>
                            
                            <!-- What to Observe -->
                            <div class="flex items-start mt-auto">
                                <span class="tooltip">
                                    <span class="inline-flex items-center justify-center p-1.5 bg-yellow-100 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-300 rounded-full">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                    </span>
                                    <span class="tooltip-text" style="width: 280px;">
                                        <strong>What to Observe:</strong>
                                        <ul class="mt-1 ml-4 list-disc">
                                            <li>Try different partition keys and notice how records redistribute</li>
                                            <li>Look for uneven distributions (poor "Distribution Score")</li>
                                            <li>Notice how certain attributes create "hot partitions"</li>
                                            <li>See how sort keys organize data within partitions but don't affect distribution</li>
                                            <li>Run queries to see which shards must be accessed to retrieve data</li>
                                        </ul>
                                    </span>
                                </span>
                                <button id="toggle-analysis" class="ml-auto text-xs bg-indigo-50 dark:bg-indigo-900/30 hover:bg-indigo-100 dark:hover:bg-indigo-800/40 px-2 py-1 rounded text-indigo-700 dark:text-indigo-300">
                                    Show Analysis
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="lg:col-span-8">
                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-4">
                            <div class="flex flex-wrap justify-between items-center mb-4">
                                <h2 class="text-lg font-semibold flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-indigo-600 dark:text-indigo-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2 1 3 3 3h10c2 0 3-1 3-3V7c0-2-1-3-3-3H7c-2 0-3 1-3 3z" />
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 11h6M9 17h6" />
                                    </svg>
                                    Shard Visualization
                                </h2>
                                
                                <div class="flex space-x-4">
                                    <!-- Student Records Partition Keys -->
                                    <div id="student-partition-keys">
                                        <label class="flex items-center text-xs font-medium mb-1" for="student-partition-key">
                                            Partition Key
                                            <span class="tooltip ml-1">
                                                <span class="tooltip-icon">i</span>
                                                <span class="tooltip-text">The primary key that determines how data is physically distributed across shards. Choose carefully - a good partition key should have high cardinality (many unique values) to ensure even distribution.</span>
                                            </span>
                                        </label>
                                        <select id="student-partition-key" class="p-1.5 border dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-sm min-w-[120px]">
                                            <option value="studentId">Student ID</option>
                                            <option value="courseId">Course ID</option>
                                            <option value="gender">Gender</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Sensor Data Partition Keys -->
                                    <div id="sensor-partition-keys" class="hidden">
                                        <label class="flex items-center text-xs font-medium mb-1" for="sensor-partition-key">
                                            Partition Key
                                            <span class="tooltip ml-1">
                                                <span class="tooltip-icon">i</span>
                                                <span class="tooltip-text">The primary key that determines how data is physically distributed across shards. Choose carefully - a good partition key should have high cardinality (many unique values) to ensure even distribution.</span>
                                            </span>
                                        </label>
                                        <select id="sensor-partition-key" class="p-1.5 border dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-sm min-w-[120px]">
                                            <option value="sensorId">Sensor ID</option>
                                            <option value="location">Location</option>
                                            <option value="timestamp">Timestamp</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Student Records Sort Keys -->
                                    <div id="student-sort-keys">
                                        <label class="flex items-center text-xs font-medium mb-1" for="student-sort-key">
                                            Sort Key
                                            <span class="tooltip ml-1">
                                                <span class="tooltip-icon">i</span>
                                                <span class="tooltip-text">The secondary key that determines how data is sorted within each partition. Sort keys enable efficient range queries and don't affect distribution across shards.</span>
                                            </span>
                                        </label>
                                        <select id="student-sort-key" class="p-1.5 border dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-sm min-w-[120px]">
                                            <option value="none">None</option>
                                            <option value="studentId">Student ID</option>
                                            <option value="courseId">Course ID</option>
                                            <option value="grade">Grade</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Sensor Data Sort Keys -->
                                    <div id="sensor-sort-keys" class="hidden">
                                        <label class="flex items-center text-xs font-medium mb-1" for="sensor-sort-key">
                                            Sort Key
                                            <span class="tooltip ml-1">
                                                <span class="tooltip-icon">i</span>
                                                <span class="tooltip-text">The secondary key that determines how data is sorted within each partition. Sort keys enable efficient range queries and don't affect distribution across shards.</span>
                                            </span>
                                        </label>
                                        <select id="sensor-sort-key" class="p-1.5 border dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-sm min-w-[120px]">
                                            <option value="none">None</option>
                                            <option value="timestamp">Timestamp</option>
                                            <option value="temperature">Temperature</option>
                                            <option value="sensorId">Sensor ID</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Shard Count -->
                                    <div>
                                        <label class="flex items-center text-xs font-medium mb-1" for="shard-count">
                                            Shards: <span id="shard-count-display">1</span>
                                            <span class="tooltip ml-1">
                                                <span class="tooltip-icon">i</span>
                                                <span class="tooltip-text">Number of physical partitions storing your data. In real DynamoDB, AWS manages this automatically based on your throughput needs.</span>
                                            </span>
                                        </label>
                                        <input 
                                            type="range" 
                                            id="shard-count" 
                                            min="1" 
                                            max="5" 
                                            step="1" 
                                            value="1"
                                            class="w-32 h-2 mt-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer"
                                        >
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Shards Container -->
                            <div id="shards-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                <!-- Shards will be inserted here -->
                            </div>
                            
                            <!-- Key Combination Analysis -->
                            <div id="key-combination-analysis" class="mt-4 p-4 bg-indigo-50 dark:bg-indigo-900/30 rounded-lg border border-indigo-100 dark:border-indigo-800 hidden">
                                <div class="flex justify-between items-start">
                                    <h3 class="text-md font-medium mb-2 text-indigo-800 dark:text-indigo-300">Key Combination Analysis</h3>
                                    <button id="hide-analysis" class="text-xs bg-indigo-100 dark:bg-indigo-800 hover:bg-indigo-200 dark:hover:bg-indigo-700 px-2 py-1 rounded text-indigo-700 dark:text-indigo-300">
                                        Hide
                                    </button>
                                </div>
                                <div id="key-analysis-content" class="prose prose-sm dark:prose-invert max-w-none">
                                    <!-- Content will be dynamically inserted here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Help Tab -->
            <div id="help" class="tab-pane hidden">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 prose dark:prose-invert max-w-none">
                    <h2 class="text-2xl font-bold mb-4 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-purple-600 dark:text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        Understanding DynamoDB Partitioning
                    </h2>
                    
                    <!-- Help Subtabs Navigation -->
                    <div class="flex border-b border-gray-300 dark:border-gray-700 mb-6 overflow-x-auto">
                        <button class="help-tab-button px-4 py-2 text-sm font-medium focus:outline-none border-b-2 border-purple-600 dark:border-purple-400 text-purple-600 dark:text-purple-400" data-help-tab="key-concepts">
                            Key Concepts
                        </button>
                        <button class="help-tab-button px-4 py-2 text-sm font-medium focus:outline-none border-b-2 border-transparent hover:border-gray-300 dark:hover:border-gray-700" data-help-tab="partitioning">
                            Partitioning
                        </button>
                        <button class="help-tab-button px-4 py-2 text-sm font-medium focus:outline-none border-b-2 border-transparent hover:border-gray-300 dark:hover:border-gray-700" data-help-tab="best-practices">
                            Best Practices
                        </button>
                        <button class="help-tab-button px-4 py-2 text-sm font-medium focus:outline-none border-b-2 border-transparent hover:border-gray-300 dark:hover:border-gray-700" data-help-tab="examples">
                            Examples
                        </button>
                        <button class="help-tab-button px-4 py-2 text-sm font-medium focus:outline-none border-b-2 border-transparent hover:border-gray-300 dark:hover:border-gray-700" data-help-tab="experiments">
                            Experiments
                        </button>
                    </div>

                    <!-- Help Subtab Content -->
                    <div class="help-tab-content">
                        <!-- Key Concepts Tab -->
                        <div id="key-concepts" class="help-tab-pane">
                            <div class="mb-8">
                                <h3 class="text-xl font-bold text-purple-700 dark:text-purple-400 border-b pb-2">What is DynamoDB?</h3>
                                <p>Amazon DynamoDB is a fully managed NoSQL database service that provides fast and predictable performance with seamless scalability. With DynamoDB, you don't need to worry about hardware provisioning, setup, configuration, replication, software patching, or cluster scaling.</p>
                                <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg my-4 border border-blue-100 dark:border-blue-800">
                                    <p class="font-medium text-blue-800 dark:text-blue-300">Key advantages of DynamoDB:</p>
                                    <ul>
                                        <li><strong>Serverless:</strong> No servers to manage</li>
                                        <li><strong>Scalable:</strong> Can handle virtually any workload, scaling up or down automatically</li>
                                        <li><strong>Fast:</strong> Single-digit millisecond response times</li>
                                        <li><strong>Highly Available:</strong> Data is replicated across multiple Availability Zones</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg border border-blue-100 dark:border-blue-800 shadow-sm mt-6 mb-8">
                                <div class="flex items-start">
                                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-800 flex items-center justify-center mr-3">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                    </div>
                                    <div>
                                        <h4 class="text-lg font-semibold text-blue-800 dark:text-blue-300 mt-0">This Simulation</h4>
                                        <p class="text-blue-700 dark:text-blue-200">This interactive simulation helps you understand the core concepts of DynamoDB through practical examples with student records and sensor data. You'll learn about partition keys, sort keys, data distribution, and how these choices affect performance and scalability.</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h3 class="text-xl font-bold text-purple-700 dark:text-purple-400 border-b pb-2">Key Concepts in DynamoDB</h3>
                                
                                <div class="space-y-6 mt-4">
                                    <div>
                                        <h4 class="font-bold text-lg">Partition Key</h4>
                                        <p>The primary key that uniquely identifies each item in a DynamoDB table. DynamoDB uses the partition key's value as input to an internal hash function to determine where the data will be stored physically.</p>
                                        <div class="bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-md border border-yellow-100 dark:border-yellow-800 mt-2">
                                            <p class="text-yellow-800 dark:text-yellow-300 text-sm"><strong>Important:</strong> The partition key is fundamental to data distribution across partitions (shards). A good partition key should have:</p>
                                            <ul>
                                                <li>High cardinality (many distinct values)</li>
                                                <li>Even distribution</li>
                                                <li>No "hot" values that get accessed much more frequently than others</li>
                                            </ul>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h4 class="font-bold text-lg">Sort Key (Range Key)</h4>
                                        <p>An optional second part of a composite primary key. If used, the sort key allows you to organize data within each partition and enables you to query items efficiently.</p>
                                        <div class="bg-indigo-50 dark:bg-indigo-900/20 p-3 rounded-md border border-indigo-100 dark:border-indigo-800 mt-2 text-sm">
                                            <p class="text-indigo-800 dark:text-indigo-300">With a sort key, you can:</p>
                                            <ul>
                                                <li>Perform range queries on the sort key within a partition</li>
                                                <li>Sort data within a partition</li>
                                                <li>Store related items close together for more efficient access</li>
                                            </ul>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h4 class="font-bold text-lg">Shards/Partitions</h4>
                                        <p>DynamoDB automatically divides your table data across multiple partitions (also known as shards), each stored on a separate storage node. In this simulation, you can see how records are distributed across these partitions based on the selected partition key.</p>
                                    </div>

                                    <div>
                                        <h4 class="font-bold text-lg">Hot Partitions</h4>
                                        <p>When data or traffic is unevenly distributed across partitions, it can lead to "hot" partitions that receive a disproportionate amount of requests. This situation can cause performance issues and throttling.</p>
                                        <div class="mt-2 bg-red-50 dark:bg-red-900/20 p-3 rounded border border-red-100 dark:border-red-800">
                                            <p class="text-red-800 dark:text-red-300 text-sm font-medium">Signs of hot partitions:</p>
                                            <ul>
                                                <li>One or few partitions contain significantly more data than others</li>
                                                <li>Your application gets throttling errors despite having sufficient provisioned capacity</li>
                                                <li>Request patterns focus heavily on specific key values</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        

                        
                        <!-- Partitioning Tab -->
                        <div id="partitioning" class="help-tab-pane hidden">
                            <div class="mb-8">
                                <h3 class="text-xl font-bold text-purple-700 dark:text-purple-400 border-b pb-2">How Partitioning Works</h3>
                                
                                <div class="mt-4">
                                    <h4 class="font-bold text-lg">The Hashing Process</h4>
                                    <p>When you store data in DynamoDB, the service computes a hash value of the partition key. This hash value determines which partition the item will be stored in.</p>
                                    
                                    <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-md my-4 font-mono text-sm overflow-auto">
                                        <pre class="text-gray-800 dark:text-gray-200">
// Simplified hash function (similar to what's used in our simulation)
function hash(partitionKeyValue) {
    let hash = 0;
    for (let i = 0; i < partitionKeyValue.length; i++) {
        hash = ((hash << 5) - hash) + partitionKeyValue.charCodeAt(i);
        hash = hash & hash; // Convert to 32-bit integer
    }
    return Math.abs(hash);
}

// Determine which shard will store the data
const shardNumber = hash(partitionKeyValue) % numberOfShards;
</pre>
                                    </div>
                                    
                                    <h4 class="font-bold text-lg mt-6">Example Using Our Student Data</h4>
                                    <p>Let's look at how the partition key value "S1001" (a Student ID) is hashed and assigned to a partition with 3 shards:</p>
                                    
                                    <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-md border border-gray-200 dark:border-gray-700 my-4">
                                        <ol>
                                            <li><strong>1.</strong> Compute hash of "S1001" = 2794030</li>
                                            <li><strong>2.</strong> Calculate shardNumber = 2794030 % 3 = <strong>1</strong></li>
                                            <li><strong>3.</strong> Store the record in shard 1</li>
                                        </ol>
                                        <p class="mt-3 text-sm">This same process applies to all records. The hash function ensures that the distribution is (pseudo)random but deterministic - the same partition key value will always hash to the same partition.</p>
                                    </div>
                                    
                                    <div class="flex flex-col md:flex-row gap-4 mt-6">
                                        <div class="flex-1 bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg">
                                            <h5 class="font-bold text-blue-800 dark:text-blue-300">Advantages of Hashing</h5>
                                            <ul class="mt-2 ml-5 space-y-1 text-blue-700 dark:text-blue-200 text-sm">
                                                <li>Distributes data across partitions</li>
                                                <li>Enables parallel processing</li>
                                                <li>Makes scaling easier</li>
                                                <li>Avoids sequential bottlenecks</li>
                                            </ul>
                                        </div>
                                        
                                        <div class="flex-1 bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-lg">
                                            <h5 class="font-bold text-indigo-800 dark:text-indigo-300">Hash Function Properties</h5>
                                            <ul class="mt-2 ml-5 space-y-1 text-indigo-700 dark:text-indigo-200 text-sm">
                                                <li>Deterministic: Same input always gives same output</li>
                                                <li>Uniform: Distributes values evenly</li>
                                                <li>Efficient: Fast to compute</li>
                                                <li>No predictable patterns</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Best Practices Tab -->
                        <div id="best-practices" class="help-tab-pane hidden">
                            <div>
                                <h3 class="text-xl font-bold text-purple-700 dark:text-purple-400 border-b pb-2">Best Practices for Partition Keys</h3>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
                                    <div class="bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-100 dark:border-green-800">
                                        <h4 class="font-bold text-green-800 dark:text-green-300">Good Choices ✅</h4>
                                        <ul>
                                            <li><strong>User ID</strong> - Typically has high cardinality and evenly distributed access patterns</li>
                                            <li><strong>Device ID/Sensor ID</strong> - Each device gets its own partition</li>
                                            <li><strong>UUID/GUID</strong> - Guaranteed high cardinality with random distribution</li>
                                            <li><strong>Order ID</strong> - Usually high cardinality in most systems</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-100 dark:border-red-800">
                                        <h4 class="font-bold text-red-800 dark:text-red-300">Poor Choices ❌</h4>
                                        <ul>
                                            <li><strong>Gender</strong> - Only a few distinct values (creates hot partitions)</li>
                                            <li><strong>Status</strong> - Limited values like "active", "inactive", "pending"</li>
                                            <li><strong>Boolean flags</strong> - Only two possible values</li>
                                            <li><strong>Date/Timestamp (by itself)</strong> - Can create time-based hot partitions</li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <div class="mt-6 bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-100 dark:border-purple-800">
                                    <h4 class="font-bold text-purple-800 dark:text-purple-300">Strategies to Avoid Hot Partitions</h4>
                                    <ol>
                                        <li>
                                            <strong>Use high-cardinality attributes</strong> - Choose attributes with many possible values (like ID fields)
                                        </li>
                                        <li>
                                            <strong>Add random suffixes to partition keys</strong> - For time-based data, add a random number to distribute load (e.g., "2023-07-15#42")
                                        </li>
                                        <li>
                                            <strong>Use composite keys</strong> - Combine multiple attributes to create a unique partition key (e.g., "region#user_id")
                                        </li>
                                        <li>
                                            <strong>Sharding</strong> - For hot items, create logical shards by adding a shard number to the key (e.g., "product_123#1", "product_123#2")
                                        </li>
                                    </ol>
                                </div>
                                
                                <div class="bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg border border-blue-100 dark:border-blue-800 shadow-sm mt-6">
                                    <div class="flex items-start">
                                        <div class="flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-800 flex items-center justify-center mr-3">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                            </svg>
                                        </div>
                                        <div>
                                            <h4 class="text-lg font-semibold text-blue-800 dark:text-blue-300 mt-0">Key Takeaways</h4>
                                            <ul>
                                                <li>Choose partition keys with high cardinality to ensure even data distribution</li>
                                                <li>Avoid low-cardinality attributes like status codes, boolean flags, or gender as partition keys</li>
                                                <li>Use sort keys to organize data within partitions and enable efficient range queries</li>
                                                <li>Consider your access patterns when designing your key schema</li>
                                                <li>Remember that the most efficient query is one that can target a specific partition</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Examples Tab -->
                        <div id="examples" class="help-tab-pane hidden">
                            <div>
                                <h3 class="text-xl font-bold text-purple-700 dark:text-purple-400 border-b pb-2">Example with Student Course Records</h3>
                                
                                <div class="space-y-4 mt-4">
                                    <p>Looking at our student course records dataset, we have several options for partition keys:</p>
                                    
                                    <div class="bg-white dark:bg-gray-700 rounded-md shadow-sm border border-gray-200 dark:border-gray-600 p-4">
                                        <h4 class="font-bold">Student ID as Partition Key</h4>
                                        <div class="flex flex-col md:flex-row gap-3 mt-2">
                                            <div class="flex-1">
                                                <h5 class="font-medium text-green-700 dark:text-green-400">Pros:</h5>
                                                <ul>
                                                    <li>High cardinality (many unique students)</li>
                                                    <li>Efficient for finding all courses for a specific student</li>
                                                    <li>Naturally distributes data across partitions</li>
                                                </ul>
                                            </div>
                                            <div class="flex-1">
                                                <h5 class="font-medium text-red-700 dark:text-red-400">Cons:</h5>
                                                <ul>
                                                    <li>Inefficient for course-centric queries</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-white dark:bg-gray-700 rounded-md shadow-sm border border-gray-200 dark:border-gray-600 p-4">
                                        <h4 class="font-bold">Course ID as Partition Key</h4>
                                        <div class="flex flex-col md:flex-row gap-3 mt-2">
                                            <div class="flex-1">
                                                <h5 class="font-medium text-green-700 dark:text-green-400">Pros:</h5>
                                                <ul>
                                                    <li>Good cardinality (multiple distinct courses)</li>
                                                    <li>Efficient for finding all students in a specific course</li>
                                                </ul>
                                            </div>
                                            <div class="flex-1">
                                                <h5 class="font-medium text-red-700 dark:text-red-400">Cons:</h5>
                                                <ul>
                                                    <li>Inefficient for student-centric queries</li>
                                                    <li>Popular courses could become hot partitions</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-white dark:bg-gray-700 rounded-md shadow-sm border border-gray-200 dark:border-gray-600 p-4">
                                        <h4 class="font-bold">Gender as Partition Key (Anti-pattern)</h4>
                                        <div class="flex flex-col md:flex-row gap-3 mt-2">
                                            <div class="flex-1">
                                                <h5 class="font-medium text-green-700 dark:text-green-400">Pros:</h5>
                                                <ul>
                                                    <li>Efficient for queries based on gender</li>
                                                    <li>Simple implementation</li>
                                                </ul>
                                            </div>
                                            <div class="flex-1">
                                                <h5 class="font-medium text-red-700 dark:text-red-400">Cons:</h5>
                                                <ul>
                                                    <li>Extremely low cardinality (only 2 values) creates severe hot partitions</li>
                                                    <li>Poor distribution score</li>
                                                    <li>Doesn't scale well with increased data volume</li>
                                                    <li>Violates DynamoDB best practices (avoid low-cardinality partition keys)</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="mt-3 bg-red-50 dark:bg-red-900/20 p-2 rounded text-sm text-red-700 dark:text-red-300">
                                            <strong>Warning:</strong> This is a clear anti-pattern in DynamoDB design. Try it in the simulator to see how unbalanced the distribution becomes!
                                        </div>
                                    </div>
                                </div>
                                
                                <h3 class="text-xl font-bold text-teal-700 dark:text-teal-400 border-b pb-2 mt-8">Example with Temperature Sensor Data</h3>
                                
                                <div class="space-y-4 mt-4">
                                    <p>With our temperature sensor dataset, we can explore different partitioning strategies:</p>
                                    
                                    <div class="bg-white dark:bg-gray-700 rounded-md shadow-sm border border-gray-200 dark:border-gray-600 p-4">
                                        <h4 class="font-bold">Sensor ID as Partition Key</h4>
                                        <div class="flex flex-col md:flex-row gap-3 mt-2">
                                            <div class="flex-1">
                                                <h5 class="font-medium text-green-700 dark:text-green-400">Pros:</h5>
                                                <ul>
                                                    <li>High cardinality (many unique sensors)</li>
                                                    <li>Efficient for retrieving all readings from a specific sensor</li>
                                                    <li>Good distribution across partitions</li>
                                                </ul>
                                            </div>
                                            <div class="flex-1">
                                                <h5 class="font-medium text-red-700 dark:text-red-400">Cons:</h5>
                                                <ul>
                                                    <li>Inefficient for time-based queries across all sensors</li>
                                                    <li>Can't easily query all sensors in a specific location</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-white dark:bg-gray-700 rounded-md shadow-sm border border-gray-200 dark:border-gray-600 p-4">
                                        <h4 class="font-bold">Location as Partition Key</h4>
                                        <div class="flex flex-col md:flex-row gap-3 mt-2">
                                            <div class="flex-1">
                                                <h5 class="font-medium text-green-700 dark:text-green-400">Pros:</h5>
                                                <ul>
                                                    <li>Groups sensors by geographical area</li>
                                                    <li>Efficient for location-based queries</li>
                                                    <li>Good for analyzing trends by location</li>
                                                </ul>
                                            </div>
                                            <div class="flex-1">
                                                <h5 class="font-medium text-red-700 dark:text-red-400">Cons:</h5>
                                                <ul>
                                                    <li>Medium cardinality (fewer unique values than sensor IDs)</li>
                                                    <li>Can create hot partitions if data is unevenly distributed by location</li>
                                                    <li>Inefficient for querying individual sensors</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-white dark:bg-gray-700 rounded-md shadow-sm border border-gray-200 dark:border-gray-600 p-4">
                                        <h4 class="font-bold">Timestamp as Partition Key (Anti-pattern)</h4>
                                        <div class="flex flex-col md:flex-row gap-3 mt-2">
                                            <div class="flex-1">
                                                <h5 class="font-medium text-green-700 dark:text-green-400">Pros:</h5>
                                                <ul>
                                                    <li>Efficient for time-based queries</li>
                                                    <li>Easy to understand conceptually</li>
                                                </ul>
                                            </div>
                                            <div class="flex-1">
                                                <h5 class="font-medium text-red-700 dark:text-red-400">Cons:</h5>
                                                <ul>
                                                    <li>Creates severe hot partitions for recent data</li>
                                                    <li>Most recent partition receives all new writes</li>
                                                    <li>Does not scale well as data volume increases</li>
                                                    <li>Inefficient for sensor-specific queries</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="mt-3 bg-red-50 dark:bg-red-900/20 p-2 rounded text-sm text-red-700 dark:text-red-300">
                                            <strong>Warning:</strong> Using raw timestamps as partition keys is an anti-pattern for time-series data in DynamoDB. It creates "write hot spots" as all new data goes to the same partition.
                                        </div>
                                    </div>
                                    
                                    <div class="bg-teal-50 dark:bg-teal-900/20 p-4 rounded-lg border border-teal-100 dark:border-teal-800 mt-4">
                                        <h4 class="font-bold text-teal-800 dark:text-teal-300">Better IoT Data Pattern: Composite Keys</h4>
                                        <p class="mb-2">For IoT and time-series data, a common best practice is to use composite keys:</p>
                                        <ul>
                                            <li><strong>Partition Key:</strong> SensorID (high cardinality)</li>
                                            <li><strong>Sort Key:</strong> Timestamp (enables time-based range queries per sensor)</li>
                                        </ul>
                                        <p class="mt-2">This approach provides efficient access to:</p>
                                        <ul>
                                            <li>All readings from a specific sensor</li>
                                            <li>Readings from a sensor within a specific time range</li>
                                            <li>The most recent reading from a sensor</li>
                                        </ul>
                                        <p class="mt-2 text-sm">For cross-sensor queries (e.g., all sensors in a location), you could add a Global Secondary Index with location as the partition key and timestamp as the sort key.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Experiments Tab -->
                        <div id="experiments" class="help-tab-pane hidden">
                            <div>
                                <h3 class="text-xl font-bold text-purple-700 dark:text-purple-400 border-b pb-2">Experimenting with the Simulation</h3>
                                
                                <p class="mt-4">Here are some experiments to try with our simulation to better understand DynamoDB partitioning:</p>
                                
                                <div class="space-y-4 mt-4">
                                    <div class="bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-lg border border-indigo-100 dark:border-indigo-800">
                                        <h4 class="font-bold text-indigo-800 dark:text-indigo-300">Experiment 1: Compare Partition Keys</h4>
                                        <ol>
                                            <li>Set the number of shards to 3</li>
                                            <li>Try each partition key option (Student ID, Course ID, Gender)</li>
                                            <li>Observe the distribution score and how evenly records are distributed</li>
                                            <li>Notice how Gender creates a severe imbalance with our 5:1 male-to-female ratio</li>
                                        </ol>
                                    </div>
                                    
                                    <div class="bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-lg border border-indigo-100 dark:border-indigo-800">
                                        <h4 class="font-bold text-indigo-800 dark:text-indigo-300">Experiment 2: See How Sort Keys Organize Data</h4>
                                        <ol>
                                            <li>Set StudentID as the partition key</li>
                                            <li>Add different sort keys and observe how the data is organized within each shard</li>
                                            <li>Notice that sort keys don't affect the distribution across shards, only the order within each shard</li>
                                        </ol>
                                    </div>
                                    
                                    <div class="bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-lg border border-indigo-100 dark:border-indigo-800">
                                        <h4 class="font-bold text-indigo-800 dark:text-indigo-300">Experiment 3: Observe Query Efficiency</h4>
                                        <ol>
                                            <li>Set StudentID as the partition key</li>
                                            <li>Try the "Find all courses for Student S1001" query</li>
                                            <li>Notice it only needs to access one shard</li>
                                            <li>Now change the partition key to CourseID</li>
                                            <li>Try the same query again and observe it needs to scan all shards</li>
                                        </ol>
                                    </div>
                                    
                                    <div class="bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-lg border border-indigo-100 dark:border-indigo-800">
                                        <h4 class="font-bold text-indigo-800 dark:text-indigo-300">Experiment 4: The Impact of Shard Count</h4>
                                        <ol>
                                            <li>Set Gender as the partition key to create a hot partition situation</li>
                                            <li>Start with 1 shard and observe the distribution</li>
                                            <li>Increase to 5 shards and notice how adding more shards doesn't fix the fundamental distribution problem</li>
                                            <li>Change to StudentID and observe how increasing shards works better with high-cardinality keys</li>
                                        </ol>
                                    </div>
                                    
                                    <div class="bg-teal-50 dark:bg-teal-900/20 p-4 rounded-lg border border-teal-100 dark:border-teal-800">
                                        <h4 class="font-bold text-teal-800 dark:text-teal-300">Experiment 5: IoT Data Patterns (Sensor Data)</h4>
                                        <ol>
                                            <li>Switch to the Sensor Data scenario</li>
                                            <li>Try using timestamp as the partition key and observe the hot partitions</li>
                                            <li>Switch to sensorId as the partition key and timestamp as the sort key</li>
                                            <li>Try location as a partition key and observe the distribution patterns</li>
                                            <li>Notice how this affects data distribution while still allowing time-based organization within each sensor's data</li>
                                            <li>Run queries to see how partition key choice affects query efficiency</li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // Dark mode support
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Sample data - 20 records of student course data with 5:1 male to female ratio
        const studentData = [
            { 
                studentId: "S1001", 
                studentName: "John Smith", 
                gender: "Male", 
                courseId: "CS101", 
                courseName: "Introduction to Programming", 
                grade: "A" 
            },
            { 
                studentId: "S1001", 
                studentName: "John Smith", 
                gender: "Male", 
                courseId: "MATH201", 
                courseName: "Calculus I", 
                grade: "B+" 
            },
            { 
                studentId: "S1002", 
                studentName: "Emma Johnson", 
                gender: "Female", 
                courseId: "CS101", 
                courseName: "Introduction to Programming", 
                grade: "A-" 
            },
            { 
                studentId: "S1002", 
                studentName: "Emma Johnson", 
                gender: "Female", 
                courseId: "PHYS101", 
                courseName: "Physics I", 
                grade: "B" 
            },
            { 
                studentId: "S1003", 
                studentName: "Michael Brown", 
                gender: "Male", 
                courseId: "BIO101", 
                courseName: "Biology Basics", 
                grade: "A" 
            },
            { 
                studentId: "S1004", 
                studentName: "Sophia Davis", 
                gender: "Male", 
                courseId: "CS101", 
                courseName: "Introduction to Programming", 
                grade: "B" 
            },
            { 
                studentId: "S1004", 
                studentName: "Sophia Davis", 
                gender: "Male", 
                courseId: "ENG101", 
                courseName: "English Composition", 
                grade: "A" 
            },
            { 
                studentId: "S1005", 
                studentName: "William Wilson", 
                gender: "Male", 
                courseId: "MATH201", 
                courseName: "Calculus I", 
                grade: "C+" 
            },
            { 
                studentId: "S1006", 
                studentName: "Olivia Martinez", 
                gender: "Female", 
                courseId: "CS101", 
                courseName: "Introduction to Programming", 
                grade: "A+" 
            },
            { 
                studentId: "S1006", 
                studentName: "Olivia Martinez", 
                gender: "Female", 
                courseId: "ART101", 
                courseName: "Introduction to Art", 
                grade: "A" 
            },
            { 
                studentId: "S1007", 
                studentName: "James Taylor", 
                gender: "Male", 
                courseId: "PHYS101", 
                courseName: "Physics I", 
                grade: "B-" 
            },
            { 
                studentId: "S1007", 
                studentName: "James Taylor", 
                gender: "Male", 
                courseId: "CHEM101", 
                courseName: "Chemistry I", 
                grade: "C" 
            },
            { 
                studentId: "S1008", 
                studentName: "Ava Anderson", 
                gender: "Male", 
                courseId: "BIO101", 
                courseName: "Biology Basics", 
                grade: "B+" 
            },
            { 
                studentId: "S1009", 
                studentName: "Ethan Thomas", 
                gender: "Male", 
                courseId: "CS101", 
                courseName: "Introduction to Programming", 
                grade: "C+" 
            },
            { 
                studentId: "S1010", 
                studentName: "Isabella White", 
                gender: "Male", 
                courseId: "MATH201", 
                courseName: "Calculus I", 
                grade: "A-" 
            },
            { 
                studentId: "S1010", 
                studentName: "Isabella White", 
                gender: "Male", 
                courseId: "ENG101", 
                courseName: "English Composition", 
                grade: "B+" 
            },
            { 
                studentId: "S1011", 
                studentName: "Alexander Harris", 
                gender: "Male", 
                courseId: "CS101", 
                courseName: "Introduction to Programming", 
                grade: "B" 
            },
            { 
                studentId: "S1011", 
                studentName: "Alexander Harris", 
                gender: "Male", 
                courseId: "HIST101", 
                courseName: "World History", 
                grade: "A" 
            },
            { 
                studentId: "S1012", 
                studentName: "Mia Clark", 
                gender: "Male", 
                courseId: "ART101", 
                courseName: "Introduction to Art", 
                grade: "A+" 
            },
            { 
                studentId: "S1012", 
                studentName: "Mia Clark", 
                gender: "Male", 
                courseId: "PHYS101", 
                courseName: "Physics I", 
                grade: "B-" 
            }
        ];
        
        // Sample data - 20 records of temperature sensor data
        const sensorData = [
            {
                sensorId: "sensor001",
                location: "New York",
                temperature: 27.5,
                unit: "°C",
                timestamp: "2023-07-15T08:30:00Z"
            },
            {
                sensorId: "sensor001",
                location: "New York",
                temperature: 28.2,
                unit: "°C",
                timestamp: "2023-07-15T12:30:00Z"
            },
            {
                sensorId: "sensor001",
                location: "New York",
                temperature: 26.8,
                unit: "°C",
                timestamp: "2023-07-15T16:30:00Z"
            },
            {
                sensorId: "sensor002",
                location: "Los Angeles",
                temperature: 32.1,
                unit: "°C",
                timestamp: "2023-07-15T09:15:00Z"
            },
            {
                sensorId: "sensor002",
                location: "Los Angeles",
                temperature: 33.5,
                unit: "°C",
                timestamp: "2023-07-15T13:15:00Z"
            },
            {
                sensorId: "sensor003",
                location: "Chicago",
                temperature: 25.3,
                unit: "°C",
                timestamp: "2023-07-15T10:00:00Z"
            },
            {
                sensorId: "sensor003",
                location: "Chicago",
                temperature: 26.7,
                unit: "°C",
                timestamp: "2023-07-15T14:00:00Z"
            },
            {
                sensorId: "sensor004",
                location: "London",
                temperature: 22.8,
                unit: "°C",
                timestamp: "2023-07-15T08:45:00Z"
            },
            {
                sensorId: "sensor004",
                location: "London",
                temperature: 23.1,
                unit: "°C",
                timestamp: "2023-07-15T12:45:00Z"
            },
            {
                sensorId: "sensor005",
                location: "Sydney",
                temperature: 18.9,
                unit: "°C",
                timestamp: "2023-07-15T07:30:00Z"
            },
            {
                sensorId: "sensor005",
                location: "Sydney",
                temperature: 19.5,
                unit: "°C",
                timestamp: "2023-07-15T11:30:00Z"
            },
            {
                sensorId: "sensor006",
                location: "Tokyo",
                temperature: 30.2,
                unit: "°C",
                timestamp: "2023-07-15T09:45:00Z"
            },
            {
                sensorId: "sensor006",
                location: "Tokyo",
                temperature: 31.8,
                unit: "°C",
                timestamp: "2023-07-15T13:45:00Z"
            },
            {
                sensorId: "sensor007",
                location: "Mexico City",
                temperature: 29.3,
                unit: "°C",
                timestamp: "2023-07-15T10:30:00Z"
            },
            {
                sensorId: "sensor007",
                location: "Mexico City",
                temperature: 30.5,
                unit: "°C",
                timestamp: "2023-07-15T14:30:00Z"
            },
            {
                sensorId: "sensor008",
                location: "Buenos Aires",
                temperature: 20.1,
                unit: "°C",
                timestamp: "2023-07-15T08:15:00Z"
            },
            {
                sensorId: "sensor008",
                location: "Buenos Aires",
                temperature: 21.2,
                unit: "°C",
                timestamp: "2023-07-15T12:15:00Z"
            },
            {
                sensorId: "sensor009",
                location: "San Francisco",
                temperature: 24.7,
                unit: "°C",
                timestamp: "2023-07-15T09:00:00Z"
            },
            {
                sensorId: "sensor009",
                location: "San Francisco",
                temperature: 25.3,
                unit: "°C",
                timestamp: "2023-07-15T13:00:00Z"
            },
            {
                sensorId: "sensor010",
                location: "Paris",
                temperature: 26.5,
                unit: "°C",
                timestamp: "2023-07-15T10:15:00Z"
            }
        ];

        // Function to calculate hash of a string (simplified for demo)
        function simpleHash(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                hash = ((hash << 5) - hash) + str.charCodeAt(i);
                hash = hash & hash; // Convert to 32bit integer
            }
            return Math.abs(hash);
        }
        
        // Current scenario state
        let currentScenario = "student";
        let currentData = studentData;

        // Tab switching functionality and all event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize tabs
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabPanes = document.querySelectorAll('.tab-pane');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabName = button.getAttribute('data-tab');
                    
                    // Hide all tab panes
                    tabPanes.forEach(pane => {
                        pane.classList.add('hidden');
                    });
                    
                    // Remove active state from all tabs
                    tabButtons.forEach(btn => {
                        btn.classList.remove('border-purple-600', 'dark:border-purple-400', 'text-purple-600', 'dark:text-purple-400');
                        btn.classList.add('border-transparent');
                    });
                    
                    // Show selected tab pane
                    document.getElementById(tabName).classList.remove('hidden');
                    
                    // Set active state on selected tab
                    button.classList.remove('border-transparent');
                    button.classList.add('border-purple-600', 'dark:border-purple-400', 'text-purple-600', 'dark:text-purple-400');
                });
            });
            
            // Initialize help subtabs
            const helpTabButtons = document.querySelectorAll('.help-tab-button');
            const helpTabPanes = document.querySelectorAll('.help-tab-pane');
            
            helpTabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const helpTabName = button.getAttribute('data-help-tab');
                    
                    // Hide all help tab panes
                    helpTabPanes.forEach(pane => {
                        pane.classList.add('hidden');
                    });
                    
                    // Remove active state from all help tabs
                    helpTabButtons.forEach(btn => {
                        btn.classList.remove('border-purple-600', 'dark:border-purple-400', 'text-purple-600', 'dark:text-purple-400');
                        btn.classList.add('border-transparent');
                    });
                    
                    // Show selected help tab pane
                    document.getElementById(helpTabName).classList.remove('hidden');
                    
                    // Set active state on selected help tab
                    button.classList.remove('border-transparent');
                    button.classList.add('border-purple-600', 'dark:border-purple-400', 'text-purple-600', 'dark:text-purple-400');
                });
            });
            
            // Initialize scenario selector
            const scenarioSelector = document.getElementById('scenario-selector');
            scenarioSelector.addEventListener('change', function() {
                currentScenario = this.value;
                currentData = currentScenario === 'student' ? studentData : sensorData;
                
                // Update visibility of scenario-specific elements
                toggleScenarioElements();
                
                // Update data explorer view
                updateDataExplorer();
                
                // Update visualization
                updateShardVisualization();
            });
            
            // Display data in the Data Explorer tab
            updateDataExplorer();
            
            // Add event listeners for configuration changes
            document.getElementById('student-partition-key').addEventListener('change', updateShardVisualization);
            document.getElementById('student-sort-key').addEventListener('change', updateShardVisualization);
            document.getElementById('sensor-partition-key').addEventListener('change', updateShardVisualization);
            document.getElementById('sensor-sort-key').addEventListener('change', updateShardVisualization);
            
            // Initialize shard count slider
            const shardCountSlider = document.getElementById('shard-count');
            shardCountSlider.addEventListener('input', function() {
                document.getElementById('shard-count-display').textContent = this.value;
                updateShardVisualization();
            });
            
            // Setup Analysis toggle
            document.getElementById('toggle-analysis').addEventListener('click', function() {
                const analysisPanel = document.getElementById('key-combination-analysis');
                analysisPanel.classList.toggle('hidden');
                this.textContent = analysisPanel.classList.contains('hidden') ? 'Show Analysis' : 'Hide Analysis';
            });
            
            // Setup hide analysis button
            document.getElementById('hide-analysis').addEventListener('click', function() {
                const analysisPanel = document.getElementById('key-combination-analysis');
                analysisPanel.classList.add('hidden');
                document.getElementById('toggle-analysis').textContent = 'Show Analysis';
            });
            
            // Setup Query selector for student scenario
            document.getElementById('student-query-selector').addEventListener('change', function() {
                if (currentScenario !== 'student') return;
                
                const partitionKey = document.getElementById('student-partition-key').value;
                const shardCount = parseInt(document.getElementById('shard-count').value);
                const shards = {};
                
                // Rebuild shards
                for (let i = 0; i < shardCount; i++) {
                    shards[i] = [];
                }
                
                studentData.forEach(record => {
                    const partitionKeyValue = record[partitionKey];
                    const hashValue = simpleHash(partitionKeyValue.toString()) % shardCount;
                    shards[hashValue].push(record);
                });
                
                processStudentQuery(this.value, shards, partitionKey);
            });
            
            // Setup Query selector for sensor scenario
            document.getElementById('sensor-query-selector').addEventListener('change', function() {
                if (currentScenario !== 'sensor') return;
                
                const partitionKey = document.getElementById('sensor-partition-key').value;
                const shardCount = parseInt(document.getElementById('shard-count').value);
                const shards = {};
                
                // Rebuild shards
                for (let i = 0; i < shardCount; i++) {
                    shards[i] = [];
                }
                
                sensorData.forEach(record => {
                    const partitionKeyValue = record[partitionKey];
                    const hashValue = simpleHash(partitionKeyValue.toString()) % shardCount;
                    shards[hashValue].push(record);
                });
                
                processSensorQuery(this.value, shards, partitionKey);
            });
            
            // Initialize shard visualization
            updateShardVisualization();
            
            // Show first tab by default
            tabButtons[0].click();
            
            // Show the Key Concepts tab by default
            document.querySelector('[data-help-tab="key-concepts"]').click();
        });
        
        // Function to update the Data Explorer tab
        function updateDataExplorer() {
            if (currentScenario === 'student') {
                document.getElementById('student-data-explorer').classList.remove('hidden');
                document.getElementById('sensor-data-explorer').classList.add('hidden');
                document.getElementById('student-data-json').textContent = JSON.stringify(studentData, null, 2);
            } else {
                document.getElementById('student-data-explorer').classList.add('hidden');
                document.getElementById('sensor-data-explorer').classList.remove('hidden');
                document.getElementById('sensor-data-json').textContent = JSON.stringify(sensorData, null, 2);
            }
        }
        
        // Function to toggle visibility of scenario-specific elements
        function toggleScenarioElements() {
            const studentElements = [
                'student-overview',
                'student-partition-keys',
                'student-sort-keys',
                'student-query-selector'
            ];
            
            const sensorElements = [
                'sensor-overview',
                'sensor-partition-keys',
                'sensor-sort-keys',
                'sensor-query-selector'
            ];
            
            studentElements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.classList.toggle('hidden', currentScenario !== 'student');
                }
            });
            
            sensorElements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.classList.toggle('hidden', currentScenario !== 'sensor');
                }
            });
            
            // Reset query info
            document.getElementById('query-info').classList.add('hidden');
        }

        // Function to visualize data distribution across shards
        function updateShardVisualization() {
            // Determine which partition key and sort key to use based on current scenario
            let partitionKeyField, sortKeyField;
            
            if (currentScenario === 'student') {
                partitionKeyField = document.getElementById('student-partition-key').value;
                sortKeyField = document.getElementById('student-sort-key').value;
            } else {
                partitionKeyField = document.getElementById('sensor-partition-key').value;
                sortKeyField = document.getElementById('sensor-sort-key').value;
            }
            
            const shardCount = parseInt(document.getElementById('shard-count').value);
            
            // Update shard count display
            document.getElementById('shard-count-display').textContent = shardCount;
            
            // Validate that partition key and sort key are different
            if (sortKeyField !== 'none' && partitionKeyField === sortKeyField) {
                alert('Partition key and sort key cannot be the same field');
                if (currentScenario === 'student') {
                    document.getElementById('student-sort-key').value = 'none';
                } else {
                    document.getElementById('sensor-sort-key').value = 'none';
                }
                return;
            }
            
            // Update total records display
            document.getElementById('total-records').textContent = currentData.length;
            
            // Visualize the partition key distribution
            renderKeyDistribution(partitionKeyField);
            
            // Group records by their partition key value
            const shards = {};
            
            // Initialize shards with empty arrays
            for (let i = 0; i < shardCount; i++) {
                shards[i] = [];
            }
            
            currentData.forEach(record => {
                const partitionKeyValue = record[partitionKeyField];
                const hashValue = simpleHash(partitionKeyValue.toString()) % shardCount;
                shards[hashValue].push(record);
            });
            
            // Sort records within each shard if a sort key is selected
            if (sortKeyField !== 'none') {
                Object.keys(shards).forEach(shardKey => {
                    shards[shardKey].sort((a, b) => {
                        if (a[sortKeyField] < b[sortKeyField]) return -1;
                        if (a[sortKeyField] > b[sortKeyField]) return 1;
                        return 0;
                    });
                });
            }
            
            // Calculate distribution stats
            const shardSizes = Object.values(shards).map(shard => shard.length);
            const maxItems = Math.max(...shardSizes);
            const totalItems = currentData.length;
            const idealItemsPerShard = totalItems / shardCount;
            
            // Simple distribution score calculation (100% means perfectly even distribution)
            const maxDeviation = Math.max(...shardSizes.map(size => Math.abs(size - idealItemsPerShard)));
            const distributionScore = Math.max(0, 100 - (maxDeviation / idealItemsPerShard * 100));
            
            // Update stats display
            document.getElementById('max-items').textContent = maxItems;
            document.getElementById('distribution-score').textContent = `${Math.round(distributionScore)}%`;
            
            // Get current query state (if any)
            let currentQueryValue;
            if (currentScenario === 'student') {
                currentQueryValue = document.getElementById('student-query-selector').value;
            } else {
                currentQueryValue = document.getElementById('sensor-query-selector').value;
            }
            
            // Update the visualization
            const shardsContainer = document.getElementById('shards-container');
            shardsContainer.innerHTML = '';
            
            // Determine grid columns based on shard count
            const columns = shardCount <= 2 ? shardCount : Math.min(3, shardCount);
            shardsContainer.className = `grid grid-cols-1 md:grid-cols-${columns} gap-4`;
            
            Object.keys(shards).sort().forEach(shardKey => {
                const shardItems = shards[shardKey];
                
                const shardElement = document.createElement('div');
                // Apply colorful shard styling
                shardElement.className = `shard shard-${shardKey % 5} p-4 border rounded-md shadow-sm`;
                
                const shardHeader = document.createElement('h3');
                shardHeader.className = 'text-sm font-medium mb-2 flex justify-between items-center';
                
                const utilizationPercentage = (shardItems.length / totalItems * 100).toFixed(1);
                const utilizationClass = utilizationPercentage > 40 ? 'text-red-600 dark:text-red-400 font-bold' : 'text-green-600 dark:text-green-400';
                
                shardHeader.innerHTML = `
                    <span>Shard ${shardKey}</span>
                    <span class="${utilizationClass}">${shardItems.length} items (${utilizationPercentage}%)</span>
                `;
                
                const recordsContainer = document.createElement('div');
                recordsContainer.className = 'space-y-2 max-h-60 overflow-y-auto';
                
                shardItems.forEach(record => {
                    const recordElement = document.createElement('div');
                    recordElement.className = 'record text-xs p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600';
                    
                    let recordContent;
                    
                    if (currentScenario === 'student') {
                        // Student record format
                        recordContent = `
                            <div class="grid grid-cols-2 gap-x-2 gap-y-1">
                                <div class="${partitionKeyField === 'studentId' ? 'font-bold text-purple-600 dark:text-purple-400' : ''}">
                                    <span class="font-medium">Student ID:</span> ${record.studentId}
                                </div>
                                <div>
                                    <span class="font-medium">Name:</span> ${record.studentName}
                                </div>
                                <div class="${partitionKeyField === 'gender' ? 'font-bold text-purple-600 dark:text-purple-400' : ''}">
                                    <span class="font-medium">Gender:</span> ${record.gender}
                                </div>
                                <div class="${partitionKeyField === 'courseId' ? 'font-bold text-purple-600 dark:text-purple-400' : ''}">
                                    <span class="font-medium">Course ID:</span> ${record.courseId}
                                </div>
                                <div>
                                    <span class="font-medium">Course:</span> ${record.courseName}
                                </div>
                                <div class="${sortKeyField === 'grade' ? 'font-bold text-blue-600 dark:text-blue-400' : ''}">
                                    <span class="font-medium">Grade:</span> ${record.grade}
                                </div>
                            </div>
                        `;
                    } else {
                        // Sensor record format
                        recordContent = `
                            <div class="grid grid-cols-2 gap-x-2 gap-y-1">
                                <div class="${partitionKeyField === 'sensorId' ? 'font-bold text-teal-600 dark:text-teal-400' : ''}">
                                    <span class="font-medium">Sensor ID:</span> ${record.sensorId}
                                </div>
                                <div class="${partitionKeyField === 'location' ? 'font-bold text-teal-600 dark:text-teal-400' : ''}">
                                    <span class="font-medium">Location:</span> ${record.location}
                                </div>
                                <div class="${sortKeyField === 'temperature' ? 'font-bold text-blue-600 dark:text-blue-400' : ''}">
                                    <span class="font-medium">Temp:</span> ${record.temperature}${record.unit}
                                </div>
                                <div class="${partitionKeyField === 'timestamp' || sortKeyField === 'timestamp' ? 'font-bold text-' + (partitionKeyField === 'timestamp' ? 'teal' : 'blue') + '-600 dark:text-' + (partitionKeyField === 'timestamp' ? 'teal' : 'blue') + '-400' : ''}">
                                    <span class="font-medium">Time:</span> ${formatTimestamp(record.timestamp)}
                                </div>
                            </div>
                        `;
                    }
                    
                    recordElement.innerHTML = recordContent;
                    recordsContainer.appendChild(recordElement);
                });
                
                shardElement.appendChild(shardHeader);
                shardElement.appendChild(recordsContainer);
                shardsContainer.appendChild(shardElement);
            });
            
            // Update key combination analysis
            updateKeyCombinationAnalysis(partitionKeyField, sortKeyField, distributionScore);
            
            // Re-run the current query if one is active
            if (currentQueryValue !== 'none') {
                if (currentScenario === 'student') {
                    processStudentQuery(currentQueryValue, shards, partitionKeyField);
                } else {
                    processSensorQuery(currentQueryValue, shards, partitionKeyField);
                }
            }
        }
        
        // Helper function to format timestamp
        function formatTimestamp(timestamp) {
            const date = new Date(timestamp);
            return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }

        // Function to visualize partition key distribution as a pie chart
        function renderKeyDistribution(partitionKey) {
            const distributionContainer = document.getElementById('key-distribution');
            distributionContainer.innerHTML = '';
            
            // Count occurrences of each partition key value
            const keyDistribution = {};
            currentData.forEach(record => {
                const keyValue = record[partitionKey];
                if (!keyDistribution[keyValue]) {
                    keyDistribution[keyValue] = 0;
                }
                keyDistribution[keyValue]++;
            });
            
            // Sort by count (descending)
            const sortedKeys = Object.keys(keyDistribution).sort((a, b) => 
                keyDistribution[b] - keyDistribution[a]
            );
            
            // Header with key info
            const headerDiv = document.createElement('div');
            headerDiv.className = 'text-center mb-3';
            
            headerDiv.innerHTML = `
                <div class="text-sm font-semibold">${partitionKey}</div>
                <div class="text-xs text-gray-500 dark:text-gray-400">${sortedKeys.length} distinct values</div>
            `;
            distributionContainer.appendChild(headerDiv);
            
            // Calculate total records for percentage
            const totalRecords = currentData.length;
            
            // Create the SVG container for the pie chart
            const chartContainer = document.createElement('div');
            chartContainer.className = 'flex items-center justify-center';
            
            // Fixed color palette for pie segments
            const colors = [
                '#818cf8', // indigo
                '#a78bfa', // violet
                '#c084fc', // purple
                '#e879f9', // fuchsia
                '#f472b6', // pink
                '#fb7185', // rose
                '#fca5a5', // red
                '#fdba74', // orange
                '#fcd34d', // amber
                '#fde68a',  // yellow
                '#86efac', // green
                '#5eead4', // teal
                '#93c5fd', // blue
                '#d8b4fe'  // purple
            ];
            
            // Create the dark mode colors by darkening the light mode colors
            const darkColors = colors.map(color => {
                // Simple darkening function
                return color === '#d1d5db' ? '#4b5563' : color.replace(/.$/, '7');
            });
            
            // Create SVG for pie chart (and handling "other" category)
            let svg = `<svg width="140" height="140" viewBox="0 0 100 100" class="pie-chart">`;
            
            // Group keys with small percentages into "Other" if there are many keys
            let pieData = [];
            let otherTotal = 0;
            const threshold = totalRecords * 0.03; // 3% threshold for "Other" category
            
            // If there are more than 7 keys, group small ones
            const MAX_SEGMENTS = 7;
            
            if (sortedKeys.length > MAX_SEGMENTS) {
                // Take top segments up to MAX_SEGMENTS-1 (leaving room for "Other")
                for (let i = 0; i < Math.min(sortedKeys.length, MAX_SEGMENTS - 1); i++) {
                    const key = sortedKeys[i];
                    const count = keyDistribution[key];
                    pieData.push({ key, count, percentage: (count / totalRecords * 100) });
                }
                
                // Group remaining keys as "Other"
                for (let i = MAX_SEGMENTS - 1; i < sortedKeys.length; i++) {
                    otherTotal += keyDistribution[sortedKeys[i]];
                }
                
                if (otherTotal > 0) {
                    pieData.push({ 
                        key: `${sortedKeys.length - (MAX_SEGMENTS - 1)} others`, 
                        count: otherTotal, 
                        percentage: (otherTotal / totalRecords * 100),
                        isOther: true 
                    });
                }
            } else {
                // Use all keys directly if there aren't too many
                sortedKeys.forEach(key => {
                    const count = keyDistribution[key];
                    pieData.push({ key, count, percentage: (count / totalRecords * 100) });
                });
            }
            
            // Generate pie segments
            let startAngle = 0;
            const radius = 40;
            const cx = 50;
            const cy = 50;
            
            pieData.forEach((segment, index) => {
                const percentage = segment.percentage;
                const angle = percentage * 3.6; // 3.6 = 360 / 100
                const endAngle = startAngle + angle;
                
                // Calculate the SVG arc path
                const startX = cx + radius * Math.cos(startAngle * Math.PI / 180);
                const startY = cy + radius * Math.sin(startAngle * Math.PI / 180);
                const endX = cx + radius * Math.cos(endAngle * Math.PI / 180);
                const endY = cy + radius * Math.sin(endAngle * Math.PI / 180);
                
                // Determine if the arc is large or small
                const largeArcFlag = angle > 180 ? 1 : 0;
                
                // Create the SVG path
                const path = `
                    <path 
                        d="M ${cx} ${cy} L ${startX} ${startY} A ${radius} ${radius} 0 ${largeArcFlag} 1 ${endX} ${endY} Z" 
                        fill="${colors[index % colors.length]}"
                        stroke="white" 
                        stroke-width="0.5"
                        class="segment"
                        data-key="${segment.key}"
                        data-count="${segment.count}"
                        data-percentage="${percentage.toFixed(1)}"
                    />
                `;
                
                svg += path;
                startAngle = endAngle;
            });
            
            svg += '</svg>';
            
            chartContainer.innerHTML = svg;
            distributionContainer.appendChild(chartContainer);
            
            // Create a flex container for the chart and legend (vertical layout)
            const flexContainer = document.createElement('div');
            flexContainer.className = 'flex flex-col items-center';
            
            // Add the chart to the flex container
            flexContainer.appendChild(chartContainer);
            
            // Create legend below the chart
            const legendContainer = document.createElement('div');
            legendContainer.className = 'grid grid-cols-2 gap-x-2 gap-y-1 px-2 mt-3 text-xs w-full';
            
            pieData.forEach((segment, index) => {
                const legendItem = document.createElement('div');
                legendItem.className = 'flex items-center';
                
                const colorBox = document.createElement('span');
                colorBox.className = 'w-3 h-3 inline-block mr-1 flex-shrink-0';
                colorBox.style.backgroundColor = colors[index % colors.length];
                
                const label = document.createElement('span');
                label.className = 'text-xs truncate';
                label.title = `${segment.key}: ${segment.count} records (${segment.percentage.toFixed(1)}%)`;
                label.textContent = `${segment.key.length > 8 ? segment.key.substring(0, 8) + '...' : segment.key}: ${segment.percentage.toFixed(1)}%`;
                
                legendItem.appendChild(colorBox);
                legendItem.appendChild(label);
                legendContainer.appendChild(legendItem);
            });
            
            // Add the legend to the flex container
            flexContainer.appendChild(legendContainer);
            
            // Add the flex container to the distribution container
            distributionContainer.appendChild(flexContainer);
            
            // Apply dark mode colors if needed
            if (document.documentElement.classList.contains('dark')) {
                document.querySelectorAll('.segment').forEach((segment, index) => {
                    segment.setAttribute('fill', darkColors[index % darkColors.length]);
                });
            }
            
            // Add interactivity - tooltip on hover
            const segments = document.querySelectorAll('.segment');
            segments.forEach(segment => {
                segment.addEventListener('mouseenter', function() {
                    const key = this.getAttribute('data-key');
                    const count = this.getAttribute('data-count');
                    const percentage = this.getAttribute('data-percentage');
                    
                    // Create or update tooltip
                    let tooltip = document.getElementById('pie-tooltip');
                    if (!tooltip) {
                        tooltip = document.createElement('div');
                        tooltip.id = 'pie-tooltip';
                        tooltip.className = 'absolute z-10 bg-gray-800 text-white px-2 py-1 rounded text-xs shadow-lg';
                        document.body.appendChild(tooltip);
                    }
                    
                    tooltip.textContent = `${key}: ${count} records (${percentage}%)`;
                    tooltip.style.display = 'block';
                    
                    // Position tooltip by cursor
                    document.addEventListener('mousemove', positionTooltip);
                });
                
                segment.addEventListener('mouseleave', function() {
                    const tooltip = document.getElementById('pie-tooltip');
                    if (tooltip) {
                        tooltip.style.display = 'none';
                        document.removeEventListener('mousemove', positionTooltip);
                    }
                });
            });
            
            function positionTooltip(e) {
                const tooltip = document.getElementById('pie-tooltip');
                if (tooltip) {
                    tooltip.style.left = (e.pageX + 15) + 'px';
                    tooltip.style.top = (e.pageY - 20) + 'px';
                }
            }
        }

        // Function to process student record queries
        function processStudentQuery(query, shards, partitionKey) {
            // Reset any previous highlighting
            document.querySelectorAll('.record').forEach(record => {
                record.classList.remove('bg-blue-50', 'dark:bg-blue-900/30', 'border-blue-200', 'dark:border-blue-800');
            });
            
            document.querySelectorAll('.shard').forEach(shard => {
                shard.classList.remove('border-2', 'border-blue-400', 'dark:border-blue-600');
            });
            
            const queryInfo = document.getElementById('query-info');
            const queryDetails = document.getElementById('query-details');
            const queryResults = document.getElementById('query-results');
            
            if (query === 'none') {
                queryInfo.classList.add('hidden');
                return;
            }
            
            queryInfo.classList.remove('hidden');
            
            // Parse the query
            const [queryType, queryValue] = query.split('-');
            let matchingRecords = [];
            let accessedShards = new Set();
            let queryDetailsText = '';
            
            if (queryType === 'student') {
                // If partitionKey is studentId, we can query directly on the partition key
                if (partitionKey === 'studentId') {
                    // Calculate which shard contains this student ID
                    const hashValue = simpleHash(queryValue) % Object.keys(shards).length;
                    accessedShards.add(hashValue);
                    
                    // Find all records for this student
                    shards[hashValue].forEach(record => {
                        if (record.studentId === queryValue) {
                            matchingRecords.push(record);
                        }
                    });
                    
                    queryDetailsText = `Efficient Query: This lookup only requires accessing 1 shard because studentId is the partition key.`;
                } else {
                    // If studentId is not the partition key, we need to scan all shards
                    Object.keys(shards).forEach(shardKey => {
                        shards[shardKey].forEach(record => {
                            if (record.studentId === queryValue) {
                                matchingRecords.push(record);
                                accessedShards.add(parseInt(shardKey));
                            }
                        });
                    });
                    
                    const shardCount = Object.keys(shards).length;
                    queryDetailsText = `Inefficient Query: Requires scanning ${shardCount} shards because studentId is not the partition key.`;
                }
            } else if (queryType === 'course') {
                if (partitionKey === 'courseId') {
                    // Calculate which shard contains this course ID
                    const hashValue = simpleHash(queryValue) % Object.keys(shards).length;
                    accessedShards.add(hashValue);
                    
                    // Find all records for this course
                    shards[hashValue].forEach(record => {
                        if (record.courseId === queryValue) {
                            matchingRecords.push(record);
                        }
                    });
                    
                    queryDetailsText = `Efficient Query: This lookup only requires accessing 1 shard because courseId is the partition key.`;
                } else {
                    // If courseId is not the partition key, we need to scan all shards
                    Object.keys(shards).forEach(shardKey => {
                        shards[shardKey].forEach(record => {
                            if (record.courseId === queryValue) {
                                matchingRecords.push(record);
                                accessedShards.add(parseInt(shardKey));
                            }
                        });
                    });
                    
                    const shardCount = Object.keys(shards).length;
                    queryDetailsText = `Inefficient Query: Requires scanning all ${shardCount} shards because courseId is not the partition key.`;
                }
            } else if (queryType === 'grade') {
                // Grade queries always require scanning all shards
                Object.keys(shards).forEach(shardKey => {
                    shards[shardKey].forEach(record => {
                        if (record.grade === queryValue) {
                            matchingRecords.push(record);
                            accessedShards.add(parseInt(shardKey));
                        }
                    });
                });
                
                const shardCount = Object.keys(shards).length;
                queryDetailsText = `Inefficient Query: Requires scanning all ${shardCount} shards. Attributes like grade should use a Global Secondary Index.`;
            } else if (queryType === 'gender') {
                if (partitionKey === 'gender') {
                    // Calculate which shard contains this gender
                    const hashValue = simpleHash(queryValue) % Object.keys(shards).length;
                    accessedShards.add(hashValue);
                    
                    // Find all records for this gender
                    shards[hashValue].forEach(record => {
                        if (record.gender === queryValue) {
                            matchingRecords.push(record);
                        }
                    });
                    
                    queryDetailsText = `Using gender as a partition key is efficient for gender-based queries but creates severe hot partitions.`;
                } else {
                    // If gender is not the partition key, we need to scan all shards
                    Object.keys(shards).forEach(shardKey => {
                        shards[shardKey].forEach(record => {
                            if (record.gender === queryValue) {
                                matchingRecords.push(record);
                                accessedShards.add(parseInt(shardKey));
                            }
                        });
                    });
                    
                    const shardCount = Object.keys(shards).length;
                    queryDetailsText = `Inefficient Query: Requires scanning all ${shardCount} shards. Gender is a low-cardinality attribute.`;
                }
            }
            
            // Update query results info
            queryDetails.textContent = queryDetailsText;
            queryResults.textContent = `Found ${matchingRecords.length} matching records across ${accessedShards.size} shards.`;
            
            // Highlight the accessed shards
            const shardsContainer = document.getElementById('shards-container');
            accessedShards.forEach(shardKey => {
                const shardElement = shardsContainer.children[shardKey];
                if (shardElement) {
                    shardElement.classList.add('border-2', 'border-blue-400', 'dark:border-blue-600');
                }
            });
            
            // Highlight the matching records
            document.querySelectorAll('.record').forEach(recordElement => {
                const recordContent = recordElement.textContent;
                
                const isMatch = matchingRecords.some(record => {
                    if (queryType === 'student' && recordContent.includes(`Student ID: ${queryValue}`)) {
                        return true;
                    } else if (queryType === 'course' && recordContent.includes(`Course ID: ${queryValue}`)) {
                        return true;
                    } else if (queryType === 'grade' && recordContent.includes(`Grade: ${queryValue}`)) {
                        return true;
                    } else if (queryType === 'gender' && recordContent.includes(`Gender: ${queryValue}`)) {
                        return true;
                    }
                    return false;
                });
                
                if (isMatch) {
                    recordElement.classList.add('bg-blue-50', 'dark:bg-blue-900/30', 'border-blue-200', 'dark:border-blue-800');
                }
            });
        }
        
        // Function to process sensor data queries
        function processSensorQuery(query, shards, partitionKey) {
            // Reset any previous highlighting
            document.querySelectorAll('.record').forEach(record => {
                record.classList.remove('bg-blue-50', 'dark:bg-blue-900/30', 'border-blue-200', 'dark:border-blue-800');
            });
            
            document.querySelectorAll('.shard').forEach(shard => {
                shard.classList.remove('border-2', 'border-blue-400', 'dark:border-blue-600');
            });
            
            const queryInfo = document.getElementById('query-info');
            const queryDetails = document.getElementById('query-details');
            const queryResults = document.getElementById('query-results');
            
            if (query === 'none') {
                queryInfo.classList.add('hidden');
                return;
            }
            
            queryInfo.classList.remove('hidden');
            
            // Parse the query
            const [queryType, queryValue] = query.split('-');
            let matchingRecords = [];
            let accessedShards = new Set();
            let queryDetailsText = '';
            
            if (queryType === 'sensor') {
                // If partitionKey is sensorId, we can query directly on the partition key
                if (partitionKey === 'sensorId') {
                    // Calculate which shard contains this sensor ID
                    const hashValue = simpleHash(queryValue) % Object.keys(shards).length;
                    accessedShards.add(hashValue);
                    
                    // Find all records for this sensor
                    shards[hashValue].forEach(record => {
                        if (record.sensorId === queryValue) {
                            matchingRecords.push(record);
                        }
                    });
                    
                    queryDetailsText = `Efficient Query: This lookup only requires accessing 1 shard because sensorId is the partition key.`;
                } else {
                    // If sensorId is not the partition key, we need to scan all shards
                    Object.keys(shards).forEach(shardKey => {
                        shards[shardKey].forEach(record => {
                            if (record.sensorId === queryValue) {
                                matchingRecords.push(record);
                                accessedShards.add(parseInt(shardKey));
                            }
                        });
                    });
                    
                    const shardCount = Object.keys(shards).length;
                    queryDetailsText = `Inefficient Query: Requires scanning ${shardCount} shards because sensorId is not the partition key.`;
                }
            } else if (queryType === 'temperature') {
                // Temperature queries always require scanning all shards
                Object.keys(shards).forEach(shardKey => {
                    shards[shardKey].forEach(record => {
                        if (queryValue === 'above-30' && record.temperature > 30) {
                            matchingRecords.push(record);
                            accessedShards.add(parseInt(shardKey));
                        }
                    });
                });
                
                const shardCount = Object.keys(shards).length;
                queryDetailsText = `Inefficient Query: Requires scanning all ${shardCount} shards. Range queries on non-sort key attributes require full table scans.`;
            } else if (queryType === 'location') {
                if (partitionKey === 'location') {
                    // Calculate which shard contains this location
                    const hashValue = simpleHash(queryValue) % Object.keys(shards).length;
                    accessedShards.add(hashValue);
                    
                    // Find all records for this location
                    shards[hashValue].forEach(record => {
                        if (record.location === queryValue) {
                            matchingRecords.push(record);
                        }
                    });
                    
                    queryDetailsText = `Efficient Query: This lookup only requires accessing 1 shard because location is the partition key.`;
                } else {
                    // Otherwise, we need to scan all shards
                    Object.keys(shards).forEach(shardKey => {
                        shards[shardKey].forEach(record => {
                            if (record.location === queryValue) {
                                matchingRecords.push(record);
                                accessedShards.add(parseInt(shardKey));
                            }
                        });
                    });
                    
                    const shardCount = Object.keys(shards).length;
                    queryDetailsText = `Inefficient Query: Requires scanning all ${shardCount} shards to find records from ${queryValue}.`;
                }
            } else if (queryType === 'time') {
                if (partitionKey === 'timestamp') {
                    // This would be more complex in real life, but for simplified demo:
                    Object.keys(shards).forEach(shardKey => {
                        shards[shardKey].forEach(record => {
                            const date = new Date(record.timestamp);
                            const hour = date.getUTCHours();
                            if (hour >= 6 && hour < 12) {
                                matchingRecords.push(record);
                                accessedShards.add(parseInt(shardKey));
                            }
                        });
                    });
                    
                    queryDetailsText = `Using timestamp as partition key creates hot partitions for recent data and makes time range queries inefficient.`;
                } else {
                    // Otherwise, we need to scan all shards
                    Object.keys(shards).forEach(shardKey => {
                        shards[shardKey].forEach(record => {
                            const date = new Date(record.timestamp);
                            const hour = date.getUTCHours();
                            if (hour >= 6 && hour < 12) {
                                matchingRecords.push(record);
                                accessedShards.add(parseInt(shardKey));
                            }
                        });
                    });
                    
                    const shardCount = Object.keys(shards).length;
                    queryDetailsText = `Inefficient Query: Requires scanning all ${shardCount} shards to find records from morning hours.`;
                }
            }
            
            // Update query results info
            queryDetails.textContent = queryDetailsText;
            queryResults.textContent = `Found ${matchingRecords.length} matching records across ${accessedShards.size} shards.`;
            
            // Highlight the accessed shards
            const shardsContainer = document.getElementById('shards-container');
            accessedShards.forEach(shardKey => {
                const shardElement = shardsContainer.children[shardKey];
                if (shardElement) {
                    shardElement.classList.add('border-2', 'border-blue-400', 'dark:border-blue-600');
                }
            });
            
            // Highlight the matching records
            document.querySelectorAll('.record').forEach(recordElement => {
                const recordContent = recordElement.textContent;
                
                const isMatch = matchingRecords.some(record => {
                    if (queryType === 'sensor' && recordContent.includes(`Sensor ID: ${queryValue}`)) {
                        return true;
                    } else if (queryType === 'temperature' && queryValue === 'above-30') {
                        // Extract the temperature value from content
                        const tempMatch = recordContent.match(/Temp: (\d+(\.\d+)?)/);
                        return tempMatch && parseFloat(tempMatch[1]) > 30;
                    } else if (queryType === 'location' && recordContent.includes(`Location: ${queryValue}`)) {
                        return true;
                    } else if (queryType === 'time' && queryValue === 'morning') {
                        // This would need more sophisticated parsing in real app
                        // Just check for record equality here
                        return matchingRecords.includes(record);
                    }
                    return false;
                });
                
                if (isMatch) {
                    recordElement.classList.add('bg-blue-50', 'dark:bg-blue-900/30', 'border-blue-200', 'dark:border-blue-800');
                }
            });
        }

        // Function to update key combination analysis section
        function updateKeyCombinationAnalysis(partitionKey, sortKey, distributionScore) {
            const analysisContent = document.getElementById('key-analysis-content');
            let analysisHTML = '';
            
            if (currentScenario === 'student') {
                // Analysis for student data scenario
                if (partitionKey === 'studentId') {
                    analysisHTML += `<h4 class="text-md font-medium mb-2">Student ID as Partition Key ${distributionScore >= 70 ? '✅' : '⚠️'}</h4>
                    <div class="mb-4">
                        <p><strong>Pros:</strong></p>
                        <ul>
                            <li>High cardinality (many unique values) leads to excellent data distribution (${Math.round(distributionScore)}% score)</li>
                            <li>Allows efficient retrieval of all courses for a specific student</li>
                            <li>Scales well as new students are added</li>
                        </ul>
                        <p class="mt-2"><strong>Cons:</strong></p>
                        <ul>
                            <li>Querying all students in a specific course requires a table scan or Global Secondary Index (GSI)</li>
                            <li>Not ideal if your access pattern frequently requires course-based queries</li>
                        </ul>
                        <p class="mt-2"><strong>Ideal for:</strong> Applications where student-centric operations are more common than course-centric ones.</p>
                    </div>`;
                } else if (partitionKey === 'courseId') {
                    analysisHTML += `<h4 class="text-md font-medium mb-2">Course ID as Partition Key ${distributionScore >= 70 ? '✅' : '⚠️'}</h4>
                    <div class="mb-4">
                        <p><strong>Pros:</strong></p>
                        <ul>
                            <li>Good cardinality leads to decent data distribution (${Math.round(distributionScore)}% score)</li>
                            <li>Enables efficient querying of all students in a specific course</li>
                            <li>Works well if your application frequently needs course-based analysis</li>
                        </ul>
                        <p class="mt-2"><strong>Cons:</strong></p>
                        <ul>
                            <li>Retrieving all courses for a student requires a table scan or GSI</li>
                            <li>Popular courses could potentially create hot partitions</li>
                        </ul>
                        <p class="mt-2"><strong>Ideal for:</strong> Applications where course-centric operations are more common than student-centric ones.</p>
                    </div>`;
                } else if (partitionKey === 'gender') {
                    analysisHTML += `<h4 class="text-md font-medium mb-2">Gender as Partition Key ⚠️</h4>
                    <div class="mb-4">
                        <p><strong>Pros:</strong></p>
                        <ul>
                            <li>Makes gender-based queries extremely efficient</li>
                            <li>Simple implementation</li>
                        </ul>
                        <p class="mt-2"><strong>Cons:</strong></p>
                        <ul>
                            <li>Very low cardinality (only a few unique values) creates severe hot partitions</li>
                            <li>Poor distribution score (${Math.round(distributionScore)}%)</li>
                            <li>Doesn't scale well with increased data volume</li>
                            <li>Violates DynamoDB best practices (avoid low-cardinality partition keys)</li>
                        </ul>
                        <p class="mt-2"><strong>Warning:</strong> This is an anti-pattern for DynamoDB! Low-cardinality partition keys like gender should be avoided in production environments.</p>
                    </div>`;
                }
                
                // Analysis based on sort key
                if (sortKey !== 'none') {
                    analysisHTML += `<h4 class="text-md font-medium mb-2">Using ${sortKey === 'studentId' ? 'Student ID' : sortKey === 'courseId' ? 'Course ID' : 'Grade'} as Sort Key</h4>
                    <div class="mb-4">
                        <p><strong>Effects:</strong></p>
                        <ul>`;
                        
                    if (sortKey === 'studentId') {
                        analysisHTML += `
                            <li>Records within each partition are now sorted by student ID</li>
                            <li>Enables efficient range queries for student IDs within a partition</li>
                            <li>Allows operations like "find all courses for students S1001-S1010 in partition X"</li>`;
                    } else if (sortKey === 'courseId') {
                        analysisHTML += `
                            <li>Records within each partition are now sorted by course ID</li>
                            <li>Enables efficient range queries for course IDs within a partition</li>
                            <li>Allows operations like "find all records for courses starting with CS in partition X"</li>`;
                    } else if (sortKey === 'grade') {
                        analysisHTML += `
                            <li>Records within each partition are now sorted by grade</li>
                            <li>Enables efficient grade-based queries within a partition</li>
                            <li>Allows operations like "find all A grade records in partition X" or "find all grade ranges B to A+"</li>`;
                    }
                    
                    analysisHTML += `
                        </ul>
                        <p class="mt-2"><strong>Remember:</strong> Sort keys do not affect data distribution across shards but organize data within each partition.</p>
                    </div>`;
                }
            } else {
                // Analysis for sensor data scenario
                if (partitionKey === 'sensorId') {
                    analysisHTML += `<h4 class="text-md font-medium mb-2">Sensor ID as Partition Key ${distributionScore >= 70 ? '✅' : '⚠️'}</h4>
                    <div class="mb-4">
                        <p><strong>Pros:</strong></p>
                        <ul>
                            <li>High cardinality (many unique sensors) leads to good data distribution (${Math.round(distributionScore)}% score)</li>
                            <li>Allows efficient retrieval of all readings for a specific sensor</li>
                            <li>Scales well as more sensors are added to the network</li>
                        </ul>
                        <p class="mt-2"><strong>Cons:</strong></p>
                        <ul>
                            <li>Querying data across multiple sensors requires a full table scan or GSI</li>
                            <li>Not efficient for time-based or location-based queries across sensors</li>
                        </ul>
                        <p class="mt-2"><strong>Ideal for:</strong> IoT applications where most queries are focused on individual sensor histories.</p>
                    </div>`;
                } else if (partitionKey === 'location') {
                    analysisHTML += `<h4 class="text-md font-medium mb-2">Location as Partition Key ${distributionScore >= 70 ? '✅' : '⚠️'}</h4>
                    <div class="mb-4">
                        <p><strong>Pros:</strong></p>
                        <ul>
                            <li>Good data grouping by geographic location</li>
                            <li>Enables efficient location-based queries</li>
                            <li>Distribution score: ${Math.round(distributionScore)}%</li>
                        </ul>
                        <p class="mt-2"><strong>Cons:</strong></p>
                        <ul>
                            <li>Medium cardinality - some locations may have many more records than others</li>
                            <li>Can create hot partitions if certain locations have more sensor activity</li>
                            <li>Not efficient for sensor-specific or time-based queries across locations</li>
                        </ul>
                        <p class="mt-2"><strong>Suitable for:</strong> Applications that primarily analyze data by geographical regions.</p>
                    </div>`;
                } else if (partitionKey === 'timestamp') {
                    analysisHTML += `<h4 class="text-md font-medium mb-2">Timestamp as Partition Key ⚠️</h4>
                    <div class="mb-4">
                        <p><strong>Pros:</strong></p>
                        <ul>
                            <li>Conceptually simple for time-series data</li>
                            <li>Easy to understand data organization by time</li>
                        </ul>
                        <p class="mt-2"><strong>Cons:</strong></p>
                        <ul>
                            <li>Creates severe hot partitions for recent data</li>
                            <li>Most recent partition receives all new writes</li>
                            <li>Poor distribution score (${Math.round(distributionScore)}%)</li>
                            <li>Doesn't scale well with high write volumes</li>
                            <li>Violates DynamoDB best practices for time-series data</li>
                        </ul>
                        <p class="mt-2"><strong>Warning:</strong> This is an anti-pattern for time-series data in DynamoDB! Raw timestamps as partition keys lead to hot partitions and throughput issues.</p>
                    </div>`;
                }
                
                // Analysis based on sort key
                if (sortKey !== 'none') {
                    analysisHTML += `<h4 class="text-md font-medium mb-2">Using ${sortKey === 'timestamp' ? 'Timestamp' : sortKey === 'temperature' ? 'Temperature' : 'Sensor ID'} as Sort Key</h4>
                    <div class="mb-4">
                        <p><strong>Effects:</strong></p>
                        <ul>`;
                        
                    if (sortKey === 'timestamp') {
                        analysisHTML += `
                            <li>Records within each partition are now sorted by time</li>
                            <li>Enables efficient time-range queries within a partition</li>
                            <li>Perfect for retrieving "last 24 hours of data" or "data between specific dates" for a sensor or location</li>
                            <li>Recommended pattern for time-series data: SensorID/Location (partition) + Timestamp (sort)</li>`;
                    } else if (sortKey === 'temperature') {
                        analysisHTML += `
                            <li>Records within each partition are now sorted by temperature reading</li>
                            <li>Enables efficient queries like "all readings above 30°C" within a partition</li>
                            <li>Useful for finding extreme values (min/max) for a specific sensor or location</li>`;
                    } else if (sortKey === 'sensorId') {
                        analysisHTML += `
                            <li>Records within each partition are now sorted by sensor ID</li>
                            <li>Enables efficient sensor-based queries within a partition</li>
                            <li>Useful when partitioning by location or time period</li>`;
                    }
                    
                    analysisHTML += `
                        </ul>
                        <p class="mt-2"><strong>Remember:</strong> Sort keys do not affect data distribution across shards but organize data within each partition.</p>
                    </div>`;
                }
            }
            
            // Add guidance for the current state
            if (distributionScore < 50) {
                analysisHTML += `<div class="p-3 mt-3 bg-red-100 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md">
                    <p class="text-red-800 dark:text-red-300 font-medium">⚠️ Current configuration has poor data distribution</p>
                    <p class="text-red-700 dark:text-red-400 mt-1">Consider using a partition key with higher cardinality (more unique values) for better distribution.</p>
                </div>`;
            } else if (distributionScore >= 50 && distributionScore < 70) {
                analysisHTML += `<div class="p-3 mt-3 bg-yellow-100 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md">
                    <p class="text-yellow-800 dark:text-yellow-300 font-medium">⚠️ Current configuration has moderate data distribution</p>
                    <p class="text-yellow-700 dark:text-yellow-400 mt-1">Distribution is acceptable but could be improved by selecting a partition key with higher cardinality.</p>
                </div>`;
            } else {
                analysisHTML += `<div class="p-3 mt-3 bg-green-100 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-md">
                    <p class="text-green-800 dark:text-green-300 font-medium">✅ Current configuration has good data distribution</p>
                    <p class="text-green-700 dark:text-green-400 mt-1">This setup should perform well in a production environment, with balanced load across partitions.</p>
                </div>`;
            }
            
            // Set the HTML content
            analysisContent.innerHTML = analysisHTML;
        }
    </script>
</body>
</html>
